<!DOCTYPE html>
<html lang="zh-Hans">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="Oct.13th.2021_build_to_record 题目都是三级标题 TYPE1:RSA NO.1 含有ouput文件的一道累乘及循环加密输出oct.9.2021 Csgo: 12345678910111213141516171819202122232425from Crypto.Util.number import *primelist&#x3D;[]def generate():">
<meta property="og:type" content="article">
<meta property="og:title" content="Cryptography题目练习">
<meta property="og:url" content="http://example.com/2021/10/13/Cryptography%E9%A2%98%E7%9B%AE%E7%BB%83%E4%B9%A0/index.html">
<meta property="og:site_name" content="Blog">
<meta property="og:description" content="Oct.13th.2021_build_to_record 题目都是三级标题 TYPE1:RSA NO.1 含有ouput文件的一道累乘及循环加密输出oct.9.2021 Csgo: 12345678910111213141516171819202122232425from Crypto.Util.number import *primelist&#x3D;[]def generate():">
<meta property="og:locale">
<meta property="article:published_time" content="2021-10-13T12:42:24.000Z">
<meta property="article:modified_time" content="2021-11-27T13:34:29.813Z">
<meta property="article:author" content="expansehi">
<meta property="article:tag" content="练习题">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://example.com/2021/10/13/Cryptography%E9%A2%98%E7%9B%AE%E7%BB%83%E4%B9%A0/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-Hans'
  };
</script>

  <title>Cryptography题目练习 | Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">---------------------</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/10/13/Cryptography%E9%A2%98%E7%9B%AE%E7%BB%83%E4%B9%A0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="expansehi">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Cryptography题目练习
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-10-13 20:42:24" itemprop="dateCreated datePublished" datetime="2021-10-13T20:42:24+08:00">2021-10-13</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-11-27 21:34:29" itemprop="dateModified" datetime="2021-11-27T21:34:29+08:00">2021-11-27</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Subjects-Record/" itemprop="url" rel="index"><span itemprop="name">Subjects_Record</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="oct.13th.2021_build_to_record">Oct.13th.2021_build_to_record</h1>
<h1 id="题目都是三级标题">题目都是三级标题</h1>
<h2 id="type1rsa">TYPE1:RSA</h2>
<h3 id="no.1-含有ouput文件的一道累乘及循环加密输出oct.9.2021">NO.1 含有ouput文件的一道累乘及循环加密输出oct.9.2021</h3>
<p>Csgo:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">primelist=[]</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">generate</span>():</span></span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">128</span>):</span><br><span class="line">        primelist.append(getPrime(<span class="number">512</span>))</span><br><span class="line">generate()</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(<span class="built_in">open</span>(<span class="string">&quot;flag&quot;</span>,<span class="string">&quot;rb&quot;</span>).read().strip())</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">128</span>,<span class="number">2</span>):</span><br><span class="line">    n=primelist[i]*primelist[i+<span class="number">1</span>]</span><br><span class="line">    e=<span class="number">65537</span></span><br><span class="line">    c=<span class="built_in">pow</span>(m,e,n)</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">hex</span>(c))</span><br><span class="line"></span><br><span class="line">x=<span class="number">1</span></span><br><span class="line">y=<span class="number">1</span></span><br><span class="line">z=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">128</span>,<span class="number">2</span>):</span><br><span class="line">    x*=primelist[i]</span><br><span class="line">    y*=primelist[i+<span class="number">1</span>]</span><br><span class="line">    z.append(primelist[i]*primelist[i+<span class="number">1</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(x))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(y))</span><br><span class="line"><span class="built_in">print</span>(z)</span><br></pre></td></tr></table></figure>
<h4 id="分析">分析：</h4>
<p>可以发现代码的输出包含了多个循环加密的16进制密文，以及在第二个循环中输出了一个16进制的数x，x根据代码可看出为所有偶数位置的数据乘积，而y则为所有的奇数项乘积，数组z则是每一对偶数与奇数位置数据的乘积构成，并且根据x，y在开始的赋值可以发现z的数据与n的值有关，如在数据中z的最后一组数据可以得出p64*q64的奇，而与X，Y的值进行gcd（）的运算则可以分别得到p64 、q64。此时我们已经得到了n的值，也得到了phi_n的取值，接下来的步骤就顺理成章了。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2,libnum,math  <span class="comment"># 我个人的习惯，具体情况具体分析</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">x = <span class="built_in">int</span>(<span class="string">&#x27;0xc9f926111244cc5bb82adb78908ee9ec64276a6224c8d8bad8d1c55cdcc0075f037346d18e152df79234365838d2557b60b38b444d157a648d2f650b42b4e61b16ea52bab364d241d9d3ee73d4abacdcff5965ee6d3ce1bc55ef0a387fb4196d65c035a67944d88558e5bcdbed75dceb12cd0dc3ab1bffe74203d33c136a09fe373719663bf7e963df982d94fbd425d6658ee25bea3d36e2353d0eab0e9ed91df51fab2281b832897f512995ff97e4df3c95473930a396029f06006d55f15015a8fbfda83e261156fb6bfff672873a6ed64578277f6e80d1f809da5c80ef88b3d9d0632f9af3b3669fe0b9f69389854ad623a8eba84c8471bdb75ee30ddcbd3b7c583c00e890227a9b24d09dbb7ea201b06ad98c1bd48f01e986931652d0ade39cfdb51f4342d26397df256bd476997e0005b2f381d2e7b374b386fe0172bc087fbd3f76ecae1ae62f78ff7f95807180db8e8ec85a09db44e0954b8fc8d88d8843e28cc70b61c1ccb606c31a40b642710d7f2f629fa1b8550161424bd9a54cd806fbaab2b8a95a4a80455b8d54fa1434ab93706b5999f21b7bcba8b567a73be65bf498de9395cdf4f55c333825d7063ebb62bf80a22a568e86bc008297edf72cb6fc37d52b1fd72bec576c4abfe821fec692f6cf15bd95634f1d816afdaf9f6afa0cc86ac120206ac321264b824a995c2e42cfa8dacd5dc3065ae49e5b1a3e0de713526899c517f56da57ddf277bf7e40aac8a1de116625d45c33ab437d281e48b5b9238c66ee543c776912ef4d7ec55f05d4ea45236a254435512786852309b4b363a1bb7ef4bd6b9cb5e716688ee2ac52327f1c013cca8ff6acc60c4b8a6fd65f3dbcb700f38343caa2a699d74ee47aaa5bf4b8326c10e92731b1c30704528c782f6f27a7f8d2827a723dc7cd3cf8137416e0717344395f1565b1ad8ade245fe47ccd7bc18dbcc1ea58ffaf5d60faca881860bda02dc1cf2ea5500c03877f56bd538a63796203fa170556434ee60422225fbeb2c4304986fcb28e6726ba4a451757c4fa94c9ed18d9ec38643c2a7a75fcd9f3ef6d4950cbd9620e162a686f234a185dcd393466b2a72ad744b1a5d35c17a826f3da00307402c9a1685d81e135ab76a6318f1b9eb860eacea249a3d51afb150b248cda1ebfdefade82a9311953cabc59faf7bb2ac29971339c5b4cf0ad433a3d834d9ea6e68cc352236a9c98d7be9a3172d243e0bdda8f006a89fe78418af0589433fd6ddadfa9d7633e7b1654a82e0dc87163fb1a83af999342fff2ce6b29bb85aa15eed86111d393e5357d42f2e9ffb61f4e600dbc8ea3d9d767fa7b12f0fd3e2fdadf93ea424f2e6628dab9acdc91d44718f32a7c9c727245f31238abcbe0eec33cb1c092230fcbbc7332483113c356c646dc2bf13aecbc3586d06f403ee0f881352e3f8a7d0c0308032efadc4e520ca32abcb6dcc8a332cc592b0372385fc4dcbba406f96a6570bedbe4c69b03df1bafc480b79e3b69bc0a4c16e957477fb85fa90e11b0bde49948f0226daa5a302986ff480c832edf8b65e70bae4f61786e5029aa954c7ccc08b6dbe883fdb186c6a927de86ea0d742cdd870cdf7e76d18d5023af548eba3b80127dc677d4904d6076afc0d255772978e1f00426396109080fea8bf9f1e84037eaf310c31b1a4c9ddcd6065b5438a3d62c3402d67344696cd642fc891b94bc1e35c71b9723a3b7133c8b691f05b8de36defce73129db4d990472cc81e87b3da55dbf37754a03904c219c9ec578420b8e738ce28d748977f2b07b7a5b940964eafd2b0984d3010250c7603a5bd408810430a1c1099dd2528547a7d0cbea579a2ba22d3f9fa5b392d1ece88247a2e12fc30e59d5869a3a2c2967b0e1ed8b7887a3fa60a81a075d0b7135f4928c6f8c104631ed9a0793cc963f901cc95de4882f2e641b1889fdfb76aa1e02b8d08aa3cc2f9a671690687ad6a7c1ab555284f42a88186f462e4294d20fb036ba4ccb9dfc27fd94a93aa166d629e4bc90ced7efe984216da2a69e62878eacb3cfd9fa8f9ec73fdc0d256e508efc97f2fad56daf5d252d2fcb6c95a234a630f984d07ac621463ae6f5d1b60303bd348ae5d0cd87b1aa6b8fe8ece096a6b79a08a45dbe0c6f913f25829af6522094943181f075814fbefc3d0286f7788d3d64823dbe1c93d6e125665548dc4ab7573eb616c34e88ec29d6292ef7b3c075f9d46a83c280b1bc14a23c7ce0f2d082c5f605d15886c4623046461da1ce7cda4f4a81620afbf095113e27d34eeec22f4051eb8a2143c51e749bc5c5cbca621836b002ebf98c8e1432f81bc98cf895c7f8fd4b6a085e1d9a5b05f571796aa175f516c32ebabec495047fd9484f4068b27a4986588224ab813b19d58a1db24bd5757aa68ac179d90c1a54473ee8d8232d8366061032bdbde1f37d4a379f4891776b8a2b0eb280c3abcb6a287b74bbb59af6c9b8e55fd23cd0588a7434227d06bc1e1f12db119662954b1144eb56f2e93e31d360bfca5285ea53c40b658862843e6fa3b927c6fe1b2be41bd35b57881861ca2945423eb23e64e08b98f4ba548505294b78aa270d11904ecbb19dd862b2465e4d89bb86d9fdadc38a6516b2df6f683234fc2450d7cad765ceb277eb0c2f5caa2e95fffa7882567d02d26f27b16a930dc37f304a0e7a62126736fe91f24c884cda6b4b16768b0660b4db69db64be8d251e27722d37082257c287b7baf40030a730b6f4215598615d594443e211b1d4cf1102f3e464b5aa9dfba5fa81251b38b47b4636c3166c2b580c73f70a0c99ffab15a08526a62380380c4b0365e82e30d83e254e1f6408c11d64c1630e9a7e324b2b0ba3a6b7dd6dc47e05670230ab90abfb719a608517a0767e24f0c8abcebb2654982d8e13d0787ac987a9031535868cb78c089d75b3278e6bac30adefb4d9e2b9016528bd91a648d7fb6f28cbf70613f1bf132ab5e8e28b222f6cd226c05c68270d86c69ce612e40ffcadffff338ed9dde141b0f3529047ea31cfb6d7cea8f806c6de2cdbc1122a8d1f89edbef905cf5fbb6f8f8548ffd29df89b230d470a945bc0f09110e67a32ecee82db47b8fff3de1bd9cec0196659c28f2343932187084ca0ba92dfa1173de3102f95c18d81198e1f5d8f717d94408614fb6bcbb3de9c294f80ae4f0ce81c47c1b98f098f3b0ee587b3049dd142d4db25d1fde7140cccd51ce1debd929b1d4f6fe60bb703a9a3d9b4cb4496549826076794a2f2859922cc7611611404c9287dd9dd600daa22f681d4e4aa18313c7af3e470126946988eeb3db57d5f8db4c893efba9b03d8db1575695023b525bc4529735dd4d0c57ed2b7bc0013a1b8cb26adfecc819185649e804231b5b182c91bd27ba8139188c098bcf4426e66e19395791aa51391afcb67d9906368dae9b479163df8ab2bee29e640d0fd549b656d3d77cce422f4bcd835a111e5caab3ebcf7a7fa588b539755c3a67e4442e2bdebf3021ede1097ddf3ca7cdc86d7f31bcee662ab006a23ca428b4bcae62747d9503fc4adfc3d025981a16158524fbf020e79b0a8c3e67f3efde5bfc9da83097b181c8f25642537cf533522ec7921c491736b75d6550b12b3bbade97753ee5ca65ba8a688e957eb52f3b8d188cb624e79febd7be3c58d50cb59ccbdf71b250e9d7c6b1594deab46ad3d36d3d19225604294f273f09dfbe6686c90cfa90e972752645ae85ade05b752b1b17875c9288c987b9f4e77356732e6cb9163b825f96ba2d551514e8d9a96179123c9ca0075c1ea819bff082da83806927d634f7adaae330d650512f892ef3a86478b2e6072943f1957699de0b7251bd8e87c67fbe6ca204046827506be9d464c637e4a59e028e72255d41f7db14ad86263f4fe3ec569dc0b0e61e80124598d22ba91b19d91cc42484f13439017d9883f8b6595eb8208e967f6ca6133d8b37a25fe5f6126028aa58c8e60c47b46b4ca99d68766fdbda88c081a9451be35dadef78d1def41309b1e871f28c02cd050bfa82945dbedd33da78fb2a2ac2453e06c298778ba517a0b8024037089e08b51cd79bd5085a9935adbeed42fe4c876c4ad1de64d5b17af46d13af87ff89907f8a699a92537be41e9ca640a1e3014403599eb7548a420f93871ba30b375af516cba4f293b39e71ed1201bb31a36db708a20f266c1b47e7b23d1e281ef63a5bf5524db5398165ed79f42f873445f29c2fabf751f6a58d6f60aa3fa9a9f25c0d33cf6ce1b2705287a1b9b9dd5d1cea3c51f31270b1df3f6c26e187f17807add58aaba934ab7ef79cf3c6b0333f866fa61db2dc21b193ebfe6d3280e7c662a235c4d761a6471f79150a0465d52d6e4060c8732b3f205387d516eebdb371458ea4d15d38dc35d4a4fda5423c14426b53c8d480ef44f11003084d8044908920a9245fc3bd191278bed4f24d20fcb4dbed4670b26d469c8cbc085d932234e6d9b46fbc26a167201636deb8e7134959ab839f1ebb0817a169a85412bd634b2865a959ebaa76a2118a7913a2389f9e0df7f8c19a65f6105ffcd34998e03088ab8d28f47f22015bf3e235156984e09e4980b4090c5c21c9d6854515a4a677c475ae9af4fdaf9528f3a2a6439a12c69b82797dc85821ffba99064be6eb72a935a75735ee243497588457676327b2433fb32264e10d36b37696a0c456a044a9f308040786815cad1f6eada8f964b12800fab25947ca02d25a6b806be5244468d92bccf0e491c1d12f67cfa0af27ee067c1a5a55ea404ff114c80a0aae84c67c65e30e8401da5c7218d4e847dbe64160dbaaf99842ef1819f422d21da6acf2b379941bd98eb22875ae6afb0f8c0f015509bc404d1dba3a0a364bd0b061ee7942bb62833e1e781171ed6a566d778c3f39d5ae16f789bfef1820fae3beb3d2269d183f10f2e743ea1a9c651e206298d2fe892d6310768ed886f83339ccae39f94457c35bfb4cc6f095fedc394a970eee8b7feadd50e42df3cf90c305a88f2df585e719fb2c2369396a0dd6245b7d13868e201e4567977d8714a3ac60c0a52a84e9e0bf54cf347e19e65ce57feef55d6edeeadae2def27308a62ea2abe27ece705cb2fd29d78219bb63d233c04afbf105612ed5aae9707cd1574947a8fa7a7839618f559df7ed8bf707867c2009dbc0abe25a88bceae016bf9300acb2a87470948cf277c4decde2b370f2ca3a6f5eddd6e1c5be9975895fd395b9bfefd39df95e5713879057d570f80375d08fca90c0f74438dbfdd96078988417e2e11fa6ea9d0fcb41a546a77f6008c02ed1cb2b74ee1d1126234e83a45ef67fd8cb33a3e15c877d67c9b80646812615e3720740036299d0be00b6c117971f797f11d93f42ee99565cf76c9e7e8fa423748ff5286b12dcd6f49bf8073962695cbd05775a02e28015376224cd861baa8a8c5d01c6870d092c351ad6155d22b3169bf9f8bfe5daf6abd95bf5576a9d6a906c0ee876c4c0b0db5dcdbc8e617a7c5569c917b7758f3862fcd63b80576174bbb7249c86fb24211cf86c46ed24096369a1f49b5cfbab14e6e91107ea657a9426783d69991ef0a241c533adcbdab65e550902aac968cd17b3e587c7cecc5cec70ffd364bb86b9604f812e619bd2fde5e2c026aa2bb8696c46d04aae56643e39a97c69f621680010940dd9af2b281cd78816238fa6b73110ed9178c0f6076187fb6e900b293b0410224e1b39f7369e064c9cf757741045412e8cfa3fc9b277ef82b59b4469618a8af2ff2bff240af3e955ce022303e7ff72a43&#x27;</span>,<span class="number">16</span>) </span><br><span class="line">y = <span class="built_in">int</span>(<span class="string">&#x27;0x132ab8b1094290a652853f7966b1b02711e6acd1ef34acf8dc5d4a8bddedff6489fb2abe66a61f234605b3b7abf3bd015e3b33708ed8f964202df5b3c630e40359ef7c5c8608f1816e6d7c0e0abbed302254d8544483da03f74805da5dac2f6f79228bc7232b71c8f32d8ad9239de588414c951d7aa58abefe24e36e7faf3d6d490ec401e8c93c4a918c96ba09726ea55be240f18582a7c98e1911587ec16a2d7c533c904c990b927d67f2ab35e71d4fc7e18b359772908a4c1c9b0c2dddbdbcb5f79542b6733a6deacc6cbd12f42a0b4e48c9af4cdbe06d672e157a63a150bf22621916b958fe0253f3aec8e7ecec94376aaac22e90e1735cf15fb72b33373e0be6d92236a33b1709fc49202c58466243c7696089409c28730534d5e173261bca5518121e0bda0b79742a695aee57995eec84c6706476cc88a1056ddfd3517d7d889e2b577e4a675c8b9341a431df82b392b8b6a1f3e67a0a771ce9628c6dbfbf2d92665b8f2d184b4e10e0b2f079a931b7d4626c78a464c5dddf4b0476af2ffedb36146bfb1ac65e97b07c87ce471afbfb4e8c803fe18994fdbf8a605ae4f7e2cefb1190ee4770f9f1d326bf80256ade04253f1978243c550265d5fd2969624dd225b24c0d2673e77027fff8cc7b7eb44941a6aaa0903f2111fc1971e0665d76472b4217f80c1a75de696bd13470220e59b9bdbfc1942ccafb0ae3103521ef141367590234c1d9c5496ed46e76a5b263ac43e342bd8d0480e818b0f5a46e81ba6706a11c7bce96848d72945d8096623154ee57c82b470b91310a588817357c607440eedab47c68e8bbff1fa36a5a741bf3f6af5ee3509e7417ef1ee2e0313f855a04265266ebd4e62d344ed5d439b0e50d4cc907bfbe45b8397423a546263a5710376f9cd5c1e1f130c762482914c064792ad2517f88885a2f5f40d720a997383a35bc305655fcbd4266ea24bc16d5c4fd9fb5307ad10703176b4b026c06aa65f3f2863d12ae7feab62bfbf3eda5c8bb9b5cc148034282bd0216d6543c6093eea64f9cd2a2081378d8f35fdf6bc1c35092bfe4379f19cbb3621b915ca8b0b60de1dbe556c4995d1f3bbf6c88cbfe83b7ce88133c45fefd9ea891c6f17c37e69b38a22c192e0c1ce80faf3b95a37106cb381c92f5836e2999c49d6a992ee399b22af778b48943be620e1b195f47171f3b18760286279a74df51198ab94ebbcf39e926bb06b36607a313fb34757641b8654210dea0aff1fc2c56dd22e268b871123c05390334d57557da28a37ecbfd7a88193a8375816eadadad2f5c1a0826fa10d6f3507f294c2738198f09fa74f65c5ca751b29170cd8d63a948c916af7a3b23b687b5b42bd6a2c01fa2c87980c461ac58197e692b5b40c2645c9bf3a1cb3099f7d19fcf2587f550a9bdd6ccbe463e03c49e9e1ef489e97d7a0df2de1e2e5d3cd7123c154754a226c81306ed4e75b4cd80156e7c71c911ddee5f30999b06bac81c93e4ad1085673b2874f8b7c8842f899a65dafde345529f420215a4d1ca91905ead4a779952fbef60f406fa27bf8b64b805ac1375826d0d70731f75ab243a493598ccedfc2e8aefeaef28359a6f8413f29e376a09b791630ba27cf8d2efbd144260d76a99874b74736eb7363b24b39dd4cc47f2caa91263920a03d3d76582a8d701142c24c2d767c3402f37f53377dfad9299d6e5259a115eb9a24559685c21c537841640a6752d6fcfeb183bca95fe298acddc53ed533b28923698d008c33ee28cbef2acada9f44a3f48ecc0c1ba558219969c00d90ae336181cc0c234119522c445dbd7c8dc68a10fa284e7bc22a43024d9b4fe36e830f5e7f7decf51c96c244cef5d4306b143f4e6e3882442cd1312276d3ede8309b6f3f4df42de9f101bdddae2a483573b18f59d7ac04485e93fb1f3fac2f558c7bbbf37a377cfb36aedbef93ab7b95aaed5a4cbc4f0e653f9a765cd54000a9b088d51e5196f557d73c462b67bbf63adf10b1b1b28317b77b8cdd0e4af4e999311c5da066590c5d5ac75563b79fa102f4d40b9fa42f2c9df6749bc5a86c517a78814af249e0a926000b408c0bd8f5bd7f2f8a49e73efba297253793c809fa6e6879b1ffd87de91b6ad6071de3168851cdcc2edcebc517167e95a46e78a7575b6be9c74a5e548fc61b33ca7d2a7243f28a0f76d88baa221c9d3db5d6a63d1aa0936eba1e077a4b60a6189f3f763ccd112e9736d515fe4050f042268fa25e7461236694f81ba0766cc91540604f4716ddf14b8122e16f98f5c154ce09d9623012eeb91d373bbecce7fc01f2d040cff6ec18a97613b7e6067f9864a28668540919363561cbc841833f1cf1f63e3ba269ac6cb1f716b3cd19f52ea7d29cbdee18b8b68621a0f9ef671806e6f208c3dc685e92f98f295169d6a009f33e028a030bc1fc650828fa0aac80cde4adb5b6727ad8f236957d94b9e619db6820cffa009e58f27794f21c1b6d0b15814d05be406dcb6c69773d817ab052b34276393967e40c2a04b5b760f78e2887a46f6b0cd4ca8ccf4a4a4425460b6f81b449468cd1fa2aaa84ed0af68910ec0630daf420775bfe3528c71aeac4796717aae1618f36b58c28bac1287fec93e7daf7bdd890168d52922380ec726d78a280994b8d02ce138a04b2e62cf21c44271e0462f2b512e035b810fb22820516c0c1c975c08c68194a97e034d4c8acbc510ba032e7679c262cb9cf600ce48fd327ef4a059f363d06f4185ee2503ceda365c89913557e9af7cd5ee9a728cf96a57545b2347d9149ebcb0ebe79afa6136d730b8b92b70778b051a952598e6c2f7dce08dbb9d2d3953fc7d366d0d9182cf976c6edfcd8257e7fd35d5a0f8a9dc4d9abc4bfdff84602f73ac47945b4e9989b0eeb89ec97eec2e9df702621c1ac874d84d072ed033f6a4d9fba0af24c86dad12409f0efdd34f1bafadf58393577a64602d175225b07f6a6fff048596757cde6f49a9b3f9c27c26b8d8fd55e674159c4091eb786a5f6ba383f2a3eef69134d71762f52797e355f80ef74a496abbc536fef9f1a93740b1700a97dc4f27b309f368f66447c29d6a6f569018b5606d6a5e6752341a98ccd7d71fb11d49d30ad5ef46f0d9547d4fc14f179c227cf7a74c6276c44200b28e11d9ad1804a09368ebcf3bb55b5a04f5e6b93490400b1c05b95897b285099cdd932a236a249fe359894f87dc4acfba57ae4e58e6e21bfa0661b9517571599e7044771d6537e6b85f77e209425d04134f334294ade5ae37facd37aa55b1bdebdc02b4198249ee338176c1365c22a7a5cbe9523f18670062d834bc0346e8b584df2a7339087e86bc850a8a44f4ac8a5737d2a1cd5f65e9539cf031bde95db83446214cc3f0de962eff395fb6d4c229e389b4b4d5e5fe9dacb7f13028f69ce2ee1e31ea450c166338a399137b12926d12df04099a6d3ba756bd7b818e59c3cf0c7eaaeb1a8834b03fb271f66470b19799b280676b6b3404acdecb622b90c6f858f9e82902bd3d382777904050fb94200c834da9167881401a920a1884da6f32e34ed5d5b37af32c2ad62b59574bf62f39c20fc68f510e896be3697be37e09cbf0ae9bf18b0c55cc1d536ff3f37b13c7c0f069c4556fd6463dbf50ac9bd19706c57683c63e6c3d8b5f04ff21ab880533646e1df044f984109d74db16218ebc5531aa53e037ce087cc374c301b298b15dac1648095974f237e9bcdc5fbe3b5c994a87d94c10f949cdd47c34681280461a3727c85f8207fcd8fd0e256e9f5c06a1893a80478248fbc911ac46e7bb453a1aeda3fd8d79cd8748c57e612a8c7f4560709af111e57e74e4fc07128cac9c2b83263b883a6dad0910be302c87ea442472bc85feb0fa7b3df88a4fdc7bb92055845fbcc4e2716bdb9c2bd6c19c61bd90855bca45e71cea04887e6461a9d9e78e7b24b0c43e3bb73a7dbb34b876d868f4c2ea7d4ee12ccc4957a1b2064c74dfba28618ad36cf75280bc6b48d662be0f3edd7fabe3b1d46cb0a1cd7bac150cf16a5455aac203730ee12e2e68283d6d322b133b6ac2a85d4a861364fe19be1c47c1a1e53a6718a0c092325eb0752008cad2ad5d878c20a96db70c6f7b7c852565e3b23f21d8a4fa6306866f4226c771014e75cdec11c4a7d836382b54e51d3b6bfc7ea6401048e7d1ac21b7dbb6e244df6ab4aa5b0972d6842149ed9efb08f215c7885ebc52ac3134204442d9a5483182e282de996f0f8cc894ee686c8d8dbfe2d6e22046903d4744089951b0478604d49dcb0123f2550a58af98f840563fb4a0d5c5130f18660f7cd78b6455743732e00a5c8f6276f5b7ff306feed67d26edaa72499e2bdaba4684e499f223a2557185fa9a9b063f20a727a0630954dddfd061df18211e40dfc49ff180382ad0af442252742b79b2634a96138c6accac68aadf6c64e2aacf3eee6ad1a05c7b07cbddedecdc58fc630175a42225521214b08b0a831b7bd652a1fad92e42f8417e688df2c8cec9481dc1932ca9011e452a6c1b2799135ec0a0d7e19b944ff0f05e56f54ecaf4d2869145eeb75f459bc4823bdd0badf224d5fd2997f112f9a9b1ba4c2738d4da34a3b569cf94df1a6d46a4e798f5293ade2bee7cd93124ea937cbb9654a99dcdcef28606410de07293dc97d6fe20808e105c00493774fe2628319af7201f0658eceb4fb395e316b45f4b2ed8c92320072734dcc80f74ded446a66aea5962063c9bf1c8d8539a6b3a9f297f37d6a40fa6f956a6d1816edb6004356e28f2b829b09ed97e3fa53dfff0d771ccb4d211b984372dd2bfd3193f0021149b23e3531e1d43e3d6b1ab88204ca08206fe3d52918adc31742e4fd34c838481afa2bd38af5793f161f1dbb1e024715ef2c387430d74a343c36d3955ae5e121f3f66ff2bbbca29c2b17cafed979f26edaf0f9b66b8239d7608dd930046e4cddae6fa36387dd0b82ffc2b9f6b4a125bbbb3dd86b680ef5578dedcc1752e1b71af9e15db036d34b6d1b121941420af4ec2f35ac6840dfd869cd6ca88bb03f24b2cd57c23856fe0da6828eefbc08e94ddf2712bba29486462a531e5d56db9f65d080532bc0bc6e5a6c59c449f41f59de0964a210456f54e0d4b84c914710d3556384c6535cb8eb19e9d654348e6027594a35cc641e34f9111f6f873a26fd72ba351a1089636b883dc1ae29946c6f79ac6463caabc9390d4e684dcb9769e44aac9ab42a692c5224c101060283d1ff6f760e145dff06ab0b43c4523001187191672125cc3549238cbb6aa01ea36993023177291f1060c620558319a3cd54616931389835c86dbdfe642395409e008f6c649a858fb14b108d735e22e55e4fe85a820190740263ffc2cf789d698e22762012e51e4efb149047be6b657280f8c73eb03c8f2553d73e4590d81ff359a4c0b85faccacd023ecaedfd78a27685b4c4d23b573661ddf672e9ea08c9bbf9b843f590ab89de54f432444e7298ea1623d9bb808d8bc2843db7cccb476b42776d2129e63366f29898500f44f4fd8720fbc8a7031511a16e59c6091532278d0bec1bf11651bf918f62d3549096cd037a045dab0a732c8d7a0df77e2db7bf4a5b004cd6a440d291801f427f2ced6676b1f12e77ce30986cf0e0d66f83cec9a941829f062415d8d1d5ded36650577eb550e625acaf45209a0e85814eb42f09462a3b3690f1211b1bf36a57e9a28ecde8203fa7f88d85c6cbc4d3be22e31a54fccee82b168ac3a2f53c0062b33057318e954bbc506e0f95520450424dd6ef0a6eca52d7029fc443f307&#x27;</span>,<span class="number">16</span>)</span><br><span class="line">z64 = <span class="number">95045974249473696646977141103594616763085965079685211937915851913568360278057396536200072176686955428074455935497369001433889237127585982589092139726913325167161125915766088378061005567260971118857385921672471957061708543161219671997576943532552340236092688459383804583875399858089997626081657371027645760693</span></span><br><span class="line">c64 = <span class="built_in">int</span>(<span class="string">&#x27;0x229058250a1dd8c3e4442ee7e084bcd8562cee48b70dd8a4528abcb019079e2e182ee8714a3b5b69c67d9e92d59255b046ca0cb60aa350203579b6bcbf8d59635ceead0b276c20dc3be7b7ab198f715ebf0e0b163a9d6ed9773df6b49215dbc3652853ec5703a63229e72fa00c2f1954a8344553066b13db4d28c283522e944f&#x27;</span>,<span class="number">16</span>)</span><br><span class="line">p64 = GCD(z64, x)</span><br><span class="line">q64 = GCD(z64, y)</span><br><span class="line">n64 = p64*q64</span><br><span class="line">phi_n64 = (p64-<span class="number">1</span>)*(q64-<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(GCD(e, phi_n64))  </span><br><span class="line">d = gmpy2.invert(e,phi_n64)</span><br><span class="line">m = <span class="built_in">pow</span>(c64,d,n64)</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(m))</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)))  <span class="comment"># 转换是因为出现了mpz数据类型，n2s需要int数据</span></span><br></pre></td></tr></table></figure>
<h3 id="no.2-异或运算二进制数据移位bin的应用特征分析oct.13.2021">NO.2 异或运算、二进制数据移位、bin()的应用、特征分析oct.13.2021</h3>
<p>randomCrypto :</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line">flag = <span class="string">&#x27;flag&#123;********************************&#125;&#x27;</span></span><br><span class="line">b = [ <span class="built_in">ord</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> flag ]</span><br><span class="line">a = randint(<span class="number">65</span>, <span class="built_in">max</span>(b))</span><br><span class="line">encflag=<span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag)):</span><br><span class="line">    encflag += <span class="built_in">str</span>(<span class="built_in">bin</span>((<span class="built_in">ord</span>(flag[i])^a)&lt;&lt;<span class="number">2</span>)[<span class="number">2</span>:]) + <span class="string">&#x27; &#x27;</span></span><br><span class="line"><span class="built_in">print</span> (encflag)</span><br><span class="line"></span><br><span class="line"><span class="comment">#11011000 11110000 11000100 11011100 10101100 11001000 110011000 11001100 110001100 110011100 110001000 11010100 110011100 110100100 11000100 110100100 11001000 110010100 110011100 110011000 110001000 110001000 110001100 11001100 110000100 11010100 110010000 110000100 11010000 110010100 11000100 110100100 110010000 110010000 110000000 11001000 110000000 10110100</span></span><br></pre></td></tr></table></figure>
<h4 id="分析-1">分析：</h4>
<p>可以发现加密流程是先进行了异或运算，再进行了移位，最后以二进制的形式将前两位删除（[2:]）并输出为字符串，最后进行字符串的连接。除此之外，可以知道加密明文的内容前5个字符串为'flag{'，最后一个是'}'，同时给出了若干个形似二进制的数据，而且并没有对数据进行更深的处理，此时只要将相应位置的二进制数据进行对比，逆向复原即可解出来a的值，<u>此处因为本人编程能力不足，采用了手写的方式。</u>（但是很明显用形成数组比较的方式更好处理数据）对照比较前两个输出结果发现a的二进制值应该是是X010000,1010000是80，0010000是20，所以a是80（代码中a的取值在[65,125]中，因为右滑括弧的decimal值为125（参考：<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/ASCII">ASCII</a>），由于夺棋赛的本身flag{}的特定内容形式决定，所以这里也有对加密文本进行特征分析）。</p>
<h4 id="总结">总结：</h4>
<p>对于一个没有怎么接触过Python编程（Python其实是我第一个接触的编程语言，或者说是方式）的人来说，如果硬看代码还是很难去了解代码的含义，所以这里我才去了拆开代码并带入数值的方式进行验证，同时查阅百度谷歌以及一些初级教程如菜鸟教程、CSDN等网站的讲解，这样去理解代码的作用更深刻也更准确，而不是硬看，对于编程需要动手动脑，才能加深记忆，提升能力。</p>
<h3 id="no.3-公式推导-crt模运算">NO.3 公式推导 &amp;CRT&amp;模运算</h3>
<p>eeeeezrsa :</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime,bytes_to_long</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> powmod,is_prime,invert,bit_length</span><br><span class="line"><span class="keyword">from</span> FLAG <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">RSA_genParameter</span>():</span></span><br><span class="line">    (p,q,n,e,d) = (<span class="number">0</span> <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>))</span><br><span class="line"></span><br><span class="line">    p = getPrime(<span class="number">200</span>)</span><br><span class="line">    q = p + <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span>(<span class="literal">True</span>):</span><br><span class="line">        q += <span class="number">2</span> <span class="keyword">if</span> q &amp; <span class="number">1</span> <span class="keyword">else</span> <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> is_prime(q, <span class="number">30</span>):</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">assert</span> p &lt; q</span><br><span class="line"></span><br><span class="line">    n = p*q</span><br><span class="line">    e = <span class="number">0x10001</span></span><br><span class="line">    d = invert(e, (p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">    cipherParameter = (p,q,n,e,d)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> cipherParameter</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">leak_info</span>(<span class="params">cipherParameter,c</span>):</span></span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">len</span>(cipherParameter) == <span class="number">5</span></span><br><span class="line">    (p,q,n,e,d) = cipherParameter</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Here&#x27;s sthg you may want to know.&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;n =&quot;</span>,n)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;e =&quot;</span>,e)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;c_mod_p =&quot;</span>,c % p)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;c_mod_q =&quot;</span>,c % q)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">RSA_encryption</span>(<span class="params">message,cipherParameter</span>):</span></span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">len</span>(cipherParameter) == <span class="number">5</span></span><br><span class="line">    (p,q,n,e,d) = cipherParameter</span><br><span class="line"></span><br><span class="line">    m = bytes_to_long(message)</span><br><span class="line">    <span class="keyword">assert</span> bit_length(q) &lt; bit_length(m) &lt; bit_length(n)</span><br><span class="line"></span><br><span class="line">    c = powmod(m,e,n)</span><br><span class="line">    <span class="keyword">return</span> c</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    cipherParameter = RSA_genParameter()</span><br><span class="line">    c = RSA_encryption(flag,cipherParameter)</span><br><span class="line">    leak_info(cipherParameter,c)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">n = 1868334156775298896231812470739357521959374975890291444695640351814139728754262335708297349257391991779446164262218985159</span></span><br><span class="line"><span class="string">e = 65537</span></span><br><span class="line"><span class="string">c_mod_p = 1062384575136942194457401502734355664153040886120004084031121</span></span><br><span class="line"><span class="string">c_mod_q = 255520115722444172168148366934668388396463537147929322939703</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="分析-2">分析：</h4>
<p>可以发现给出了密文模p和q的值，根据p和q的形成方式可以发现两个数据相差不大，用yafu分解得到p和q。</p>
<p>这里可以直接使用CRT的脚本进行运算，因为涉及到了线性同余方程组，也可以通过数学运算消项然后得出最后的密文。</p>
<h4 id="crt_code">CRT_code:</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2,libnum,math,binascii</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> mpz</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime,bytes_to_long,long_to_bytes</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> powmod,is_prime,invert,bit_length</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n = <span class="number">1868334156775298896231812470739357521959374975890291444695640351814139728754262335708297349257391991779446164262218985159</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">cp = <span class="number">1062384575136942194457401502734355664153040886120004084031121</span></span><br><span class="line">cq = <span class="number">255520115722444172168148366934668388396463537147929322939703</span></span><br><span class="line">q = <span class="number">1366870204801940547527182701310518853392777286350885464975291</span></span><br><span class="line">p = <span class="number">1366870204801940547527182701310518853392777286350885464974949</span></span><br><span class="line">M = p*q</span><br><span class="line">M1 = q</span><br><span class="line">M2 = p</span><br><span class="line">t1 = gmpy2.invert(M1,p)</span><br><span class="line">t2 = gmpy2.invert(M2,q)</span><br><span class="line">c = (t1*M1*cp+t2*M2*cq)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c=&#x27;</span>,c)</span><br><span class="line">phi =(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">n = p*q</span><br><span class="line">d = gmpy2.invert(e, phi)</span><br><span class="line">m = <span class="built_in">pow</span> (c,d,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;m=&#x27;</span>,m)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)))</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="推导_code">推导_code:</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c = (((cq % q- cp % p)*gmpy2.invert(p,q))%q)*p + cp % p</span><br></pre></td></tr></table></figure>
<h5 id="推导过程">推导过程：</h5>
<p>已知：</p>
<p><span class="math inline">\(n=p*q,e=65537,\phi(n)=(p-1)*(q-1),d=inv(e,\phi (n))\)</span></p>
<p><span class="math inline">\(c=m^e\pmod{n},m=c^d\pmod{n}\)</span></p>
<p><span class="math inline">\(cp\equiv c\pmod{p},cq\equiv q\pmod{q}\)</span></p>
<p>接下来的推导基于dp、dq泄露的推导过程，只不过不需要用费马小定理消项。</p>
<p>在给出了上面条件的情况下求c = ？</p>
<p>在推导前，为了方便，将cp写作c1,cq写作c2,对应n=p*q这里的位置。</p>
<p>步骤：</p>
<ol type="1">
<li><span class="math inline">\(c=m^e\pmod{n}\rightarrow c=k*n+m^e\)</span> 选择含有c和n的条件是为了找到目的数据c，和p、q两个量相关的数据n（n = p*q）进行消项。</li>
</ol>
<p>2.利用上面的等式，对等号两侧同时取模p和q(因为这个式子中含有n，而n模p、q正好可以模没，留下中介量)：</p>
<p><span class="math inline">\(c=k*n+m^e\)</span>,分别模p和q得到下面的式子</p>
<p><span class="math inline">\(c_1\equiv m_1^e\pmod{p},c_2\equiv m_2^e\pmod{q}\)</span></p>
<p>这里的<span class="math inline">\(k*n\)</span>已经被模没了("模没了"是什么<a target="_blank" rel="noopener" href="https://mysteriousexpanse.github.io/2021/10/19/43727970746F677261706879/">43727970746F677261706879</a>)</p>
<p>3.将<span class="math inline">\(c=k*p+m_1^e\)</span>代入 <span class="math inline">\(m_2^e\equiv c\pmod{q}\)</span>中</p>
<p><span class="math inline">\(m_2^e\equiv k*p+m_1^e\pmod{q}\)</span></p>
<p>4.在同余符号两边进行移项：</p>
<p><span class="math inline">\(m_2^e-m_1^e\equiv k*p\pmod{q}\)</span></p>
<p>移动p:</p>
<p><span class="math inline">\((m_2^e-m_1^e)*p^{-1}\equiv k\pmod{q}\)</span> ，<span class="math inline">\(p^{-1}\)</span>是p模q的逆元，求解方式：<span class="math inline">\(p^{-1}=gmpy2.invert(p,q)\)</span></p>
<p>5.此时可以得到一组方程：</p>
<p><span class="math inline">\(m_1^e\equiv c\pmod{p}\)</span></p>
<p><span class="math inline">\(m_2^e\equiv c\pmod{q}\)</span></p>
<p><span class="math inline">\(k\equiv (m_2^e-m_1^e)*p^{-1}\pmod{q}\)</span></p>
<p><span class="math inline">\(c=k*p+m_1^e\)</span></p>
<p>6.k代表的是模式的运行结果(原因见：<a target="_blank" rel="noopener" href="https://mysteriousexpanse.github.io/2021/10/19/%E5%AF%86%E7%A0%81%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94/#%E5%90%8C%E4%BD%99%E7%AC%A6%E5%8F%B7%E7%9A%84%E7%90%86%E8%A7%A3">同余符号的理解</a>)，即r，将r代入最后一个式子</p>
<p>得到：<span class="math inline">\(c\equiv ((m_2^e-m_1^e)*p^{-1})\pmod{q}+m_1^e\)</span></p>
<p>7.利用上面的同余式子可知<span class="math inline">\(m_1^e,m_2^e\)</span>都是模运算的结果r，将结果代入最后一个式子：</p>
<p><span class="math inline">\(c\equiv ((c\pmod{q}-c\pmod{q})*p^{-1})\pmod{q}+c\pmod{p}\)</span></p>
<p>8.此时数据（n,e,p,q,d,c）齐全，运行代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">c = (((cq % q- cp % p)*gmpy2.invert(p,q))%q)*p + cp % p</span><br><span class="line">n = p*q</span><br><span class="line">d = gmpy2.invert(e, phi)</span><br><span class="line">m = <span class="built_in">pow</span> (c,d,n)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)))</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">b&#x27;flag&#123;CRT_1s_4_v3ry_b34utiful_theorem&#125;&#x27;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<h3 id="no.4-dpdq-泄露">NO.4 dp&amp;dq 泄露</h3>
<p>BUU-RSA1:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">p = <span class="number">8637633767257008567099653486541091171320491509433615447539162437911244175885667806398411790524083553445158113502227745206205327690939504032994699902053229</span> </span><br><span class="line">q = <span class="number">12640674973996472769176047937170883420927050821480010581593137135372473880595613737337630629752577346147039284030082593490776630572584959954205336880228469</span> </span><br><span class="line">dp = <span class="number">6500795702216834621109042351193261530650043841056252930930949663358625016881832840728066026150264693076109354874099841380454881716097778307268116910582929</span> </span><br><span class="line">dq = <span class="number">783472263673553449019532580386470672380574033551303889137911760438881683674556098098256795673512201963002175438762767516968043599582527539160811120550041</span> </span><br><span class="line">c =<span class="number">24722305403887382073567316467649080662631552905960229399079107995602154418176056335800638887527614164073530437657085079676157350205351945222989351316076486573599576041978339872265925062764318536089007310270278526159678937431903862892400747915525118983959970607934142974736675784325993445942031372107342103852</span></span><br><span class="line">dp = d mod(p-<span class="number">1</span>)</span><br><span class="line">dq = d mod(q-<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<h4 id="条件">条件：</h4>
<p><span class="math inline">\(dp\equiv d\pmod {(p-1)}\)</span></p>
<p><span class="math inline">\(dq\equiv d\pmod{(q-1)}\)</span></p>
<h4 id="分析-3">分析：</h4>
<p>题目只给出了p,q,dp,dq,没有给出e,所以可以通过推导和CRT进行解题。</p>
<h4 id="推导过程-1">推导过程：</h4>
<p>找未知量：根据解题公式<span class="math inline">\(m\equiv c^d\pmod{n}\)</span>,这里缺少的是密文的私钥次方，所以未知量就是<span class="math inline">\(c^d\)</span>.</p>
<p>化为等式： <span class="math inline">\(c^d=k*n+m\)</span> ,此时可以发现n正好可以分为p*q,和条件<span class="math inline">\(\phi(p),\phi(q)\)</span>，更加接近。</p>
<p>分别模大素数：<span class="math inline">\(m_1\equiv c^d\pmod{p},m_2\equiv c^d\pmod{q}\)</span>.（<a target="_blank" rel="noopener" href="https://mysteriousexpanse.github.io/2021/10/19/%E5%AF%86%E7%A0%81%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94/#%E7%AD%89%E4%BB%B7%E5%85%B3%E7%B3%BB%E4%B8%8E%E7%AD%89%E5%8F%B7%E4%B8%A4%E4%BE%A7%E6%95%B0%E6%8D%AE%E7%A7%BB%E5%8A%A8">等价关系与等号两侧数据移动</a>）</p>
<p>从模式中找个等式：<span class="math inline">\(c^d=k*p+m_1\)</span></p>
<p>将上一行等式代入模式(<span class="math inline">\(m_2\)</span>)：<span class="math inline">\(m_2\equiv k*p+m_1\pmod{q}\)</span></p>
<p>对模式进行移项：</p>
<p>加减移项：<span class="math inline">\(m_2-m_1\equiv k*p\pmod{q}\)</span>,</p>
<p>乘法移项：<span class="math inline">\((m_2-m_1)*p^{-1}\equiv k\pmod{q}\)</span></p>
<p>对上面的最后一个式子进行互换移项（修正）：<span class="math inline">\(k\equiv (m_2-m_1)*p^{-1}\pmod{q}\)</span></p>
<p>将上面的模式整体代入上面第四行的等式：<span class="math inline">\(c^d=(m_2-m_1)*p^{-1}\pmod{q}+m_1\)</span></p>
<p>此时发现仍有未知量存在于目的数据中，去找<span class="math inline">\(m_1,m_2\)</span>替换的方式：</p>
<p>去看第三行的公式发现两者和<span class="math inline">\(c^d\)</span>有关，由dp、dq给出的数据找到：</p>
<p><span class="math inline">\(d\equiv dp\pmod{(p-1)},d\equiv dq\pmod{(q-1)}\)</span></p>
<p>再次整体代入到<span class="math inline">\(m_1,m_2\)</span>的模式中：</p>
<p><span class="math inline">\(m_1\equiv c^{dp\pmod{(p-1)}}\pmod{p},m_2\equiv c^{dq\pmod{(q-1)}}\pmod{q}\)</span></p>
<p>⚠️带错了，上一行是错误的代入方式。⚠️</p>
<p>这里代入等式：<span class="math inline">\(d=k*(p-1)+dp,d=k*(q-1)\)</span>。（这里的k 并不是相同的，根据下面推导可以发现为什么这样并不影响结果。）</p>
<p>将d代入到密文的指数位置：</p>
<p><span class="math inline">\(m_1\equiv c^{dp+k*(p-1)}\pmod{p},m_2\equiv c^{dq+k*(q-1)}\pmod{q}\)</span></p>
<p>此时发现，由于p 和q的本质是大质数，那么可以拆成:</p>
<p><span class="math inline">\(m_1\equiv c^{dp}*c^{k*(p-1)}\pmod{p},m_2\equiv c^{dq}*c^{k*(q-1)}\pmod{q}\)</span></p>
<p>这里使用<a target="_blank" rel="noopener" href="https://mysteriousexpanse.github.io/2021/10/19/%E5%AF%86%E7%A0%81%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94/#%E4%B8%8E%E8%B4%B9%E9%A9%AC%E5%B0%8F%E5%AE%9A%E7%90%86%E6%B6%88%E9%A1%B9%E6%9C%89%E5%85%B3">费马小定理</a>：（在这里我们可以发现无论对于两个大质数k的值是什么并不影响结果和化简过程）</p>
<p><span class="math inline">\(m_1\equiv c^{dp}\pmod{p},m_2\equiv c^{dq}\pmod{q}\)</span>,可以发现这种表达方式已经没有了未知数</p>
<p>我们再次回顾上面的<span class="math inline">\(c^d=(m_2-m_1)*p^{-1}\pmod{q}+m_1\)</span>，并将上一行的数据代入(这里并不是简单相等代入，而是代入余数，请看<a target="_blank" rel="noopener" href="https://mysteriousexpanse.github.io/2021/10/19/%E5%AF%86%E7%A0%81%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94/#%E7%AD%89%E5%8F%B7%E4%B8%A4%E4%BE%A7%E6%95%B0%E6%8D%AE%E7%A7%BB%E5%8A%A8%E7%9A%84%E6%8E%A8%E5%AF%BC">这里</a>)</p>
<p>得到未知数的新式子：</p>
<p><span class="math inline">\(c^d=((c^{dq}\pmod{q}-c^{dp}\pmod{q})*p^{-1})\pmod{q}*p+c^{dp}\pmod{p}\)</span></p>
<p>可以发现上面的式子是彻底没有未知数的式子，而左侧仍然是我们的目的未知量，化为代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2,libnum,cryptography</span><br><span class="line">n = p*q</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line"><span class="comment"># m = c^d mod n</span></span><br><span class="line">m1 = <span class="built_in">pow</span>(c,dp,p)</span><br><span class="line">m2 = <span class="built_in">pow</span>(c,dq,q)</span><br><span class="line">cd = ((m2-m1)*gmpy2.invert(p,q))%p+m1</span><br><span class="line">m = cd %n</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)))</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">b&#x27;noxCTF&#123;W31c0m3_70_Ch1n470wn&#125;&#x27;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<h4 id="总结-1">总结：</h4>
<p>要明白要求的目的未知数是什么，还要去找分解出来好求的数据，同时代入数据要靠近未知数，运用费马小定理消去乘积项，最终在缺少参数的情况下求出旗帜是什么。</p>
<h3 id="no.5-dp_leak-python学习">NO.5 dp_leak Python学习</h3>
<p>Buu-RSA2</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = <span class="number">248254007851526241177721526698901802985832766176221609612258877371620580060433101538328030305219918697643619814200930679612109885533801335348445023751670478437073055544724280684733298051599167660303645183146161497485358633681492129668802402065797789905550489547645118787266601929429724133167768465309665906113</span></span><br><span class="line">dp = <span class="number">905074498052346904643025132879518330691925174573054004621877253318682675055421970943552016695528560364834446303196939207056642927148093290374440210503657</span></span><br><span class="line">c = <span class="number">140423670976252696807533673586209400575664282100684119784203527124521188996403826597436883766041879067494280957410201958935737360380801845453829293997433414188838725751796261702622028587211560353362847191060306578510511380965162133472698713063592621028959167072781482562673683090590521214218071160287665180751</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="条件-1">条件：</h4>
<p><span class="math inline">\(dp\equiv d\pmod{(p-1)}\)</span>,<span class="math inline">\(e*d\equiv1\pmod{\phi(n)}\)</span>，<span class="math inline">\(\phi(n)=(p-1)*(q-1)\)</span></p>
<h4 id="分析-4">分析：</h4>
<p>这道题目只给了e,n,dp,c缺少的条件是<span class="math inline">\(m\equiv c^d\pmod{n}\)</span>中的d，而<span class="math inline">\(dp\equiv d\pmod{(p-1)}\)</span>，依旧需要通过等式和模式的推导去找到p和q。</p>
<h4 id="推导过程-2">推导过程：</h4>
<p>由<span class="math inline">\(dp\equiv d\pmod{(p-1)}\)</span>，可以根据同余的性质，同余符号左右同乘e，得到<span class="math inline">\(dp*e\equiv d*e\pmod{(p-1)}\)</span>.</p>
<p>此时还有<span class="math inline">\(e*d\equiv1\pmod{\phi(n)}\)</span>，可以建立两个等式：</p>
<p>第一个：<span class="math inline">\(dp*e=k_1*(p-1)+d*e\)</span></p>
<p>第二个：<span class="math inline">\(d*e=k_2*(p-1)(q-1)+1\)</span></p>
<p>合并，将第二个式子中<span class="math inline">\(d*e\)</span>代入第一个式子得到：</p>
<p><span class="math inline">\(dp*e=(p-1)*[k_1+k_2(q-1)]+1\)</span>，观察式子，可以发现dp是小于(p-1)的（<a target="_blank" rel="noopener" href="https://mysteriousexpanse.github.io/2021/10/19/%E5%AF%86%E7%A0%81%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94/#%E5%90%8C%E4%BD%99%E7%B1%BB">模过了</a>），这里令</p>
<p><span class="math inline">\(x=[k_1+k_2*(q-1)]\)</span>,可以发现x的值要小于e（1在几乎可以忽略的情况下），这里可以用<span class="math inline">\(a*b=c*d,a&gt;c,d&gt;b\)</span>,这样来理解。</p>
<p>所以这里可以得到<span class="math inline">\(x\in(1,e)\)</span>,则可以通过遍历<span class="math inline">\((1,e)\)</span>，进而求取<span class="math inline">\((p-1)\)</span>,p和其他数据。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> mpz</span><br><span class="line"><span class="keyword">from</span> decimal <span class="keyword">import</span> *</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = <span class="number">248254007851526241177721526698901802985832766176221609612258877371620580060433101538328030305219918697643619814200930679612109885533801335348445023751670478437073055544724280684733298051599167660303645183146161497485358633681492129668802402065797789905550489547645118787266601929429724133167768465309665906113</span></span><br><span class="line">dp = <span class="number">905074498052346904643025132879518330691925174573054004621877253318682675055421970943552016695528560364834446303196939207056642927148093290374440210503657</span></span><br><span class="line">c = <span class="number">140423670976252696807533673586209400575664282100684119784203527124521188996403826597436883766041879067494280957410201958935737360380801845453829293997433414188838725751796261702622028587211560353362847191060306578510511380965162133472698713063592621028959167072781482562673683090590521214218071160287665180751</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,e):</span><br><span class="line">    <span class="keyword">if</span> (dp*e-<span class="number">1</span>)%i == <span class="number">0</span>:</span><br><span class="line">        p = (dp*e-<span class="number">1</span>)//i+<span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> n%p == <span class="number">0</span>:</span><br><span class="line">            q = n//p</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;p and q :&#x27;</span>,p,q)</span><br><span class="line">            phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">            d = gmpy2.invert(e, phi)</span><br><span class="line">            m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m))) <span class="comment"># 修正</span></span><br></pre></td></tr></table></figure>
<h4 id="总结-2">总结：</h4>
<p>在解题时，开始是直接自己写了一行，发现网上的code正好没什么问题，然而运行后出现了一些问题。</p>
<p>1，如在运行以下代码时出现的问题是d为"Nonetype",输出为无类型</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getd</span>(<span class="params">n,e,dp</span>):</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,e):</span><br><span class="line">        <span class="keyword">if</span> (dp*e-<span class="number">1</span>)%i == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">if</span> n%(((dp*e-<span class="number">1</span>)/i)+<span class="number">1</span>)==<span class="number">0</span>:  <span class="comment"># 报错：OverflowError:int too large to convert to float</span></span><br><span class="line">                p=((dp*e-<span class="number">1</span>)/i)+<span class="number">1</span></span><br><span class="line">                q=n/(((dp*e-<span class="number">1</span>)/i)+<span class="number">1</span>)</span><br><span class="line">                phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">                d = gmpy2.invert(e,phi)%phi</span><br><span class="line">                <span class="keyword">return</span> d</span><br></pre></td></tr></table></figure>
<p>而在某些情况下还会出现”OverflowError: long int too large to convert to float in python“的报错，这里主要是line4， n%数据时。在写代码的过程中还涉及了运算符号的区别，如"//"是取整除，返回商，"%"是取余数，返回余数，检查是否能被整除可以选择用%也可以用//，分母过于复杂”似乎”会触发这个报错（待修正）。</p>
<h3 id="no.6-小明文">NO.6 小明文</h3>
<p>Buu Dangerous RSA:</p>
<p>1，首先将文本改为.py后缀并空格预览发现内容如下：、</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#n:  0x52d483c27cd806550fbe0e37a61af2e7cf5e0efb723dfc81174c918a27627779b21fa3c851e9e94188eaee3d5cd6f752406a43fbecb53e80836ff1e185d3ccd7782ea846c2e91a7b0808986666e0bdadbfb7bdd65670a589a4d2478e9adcafe97c6ee23614bcb2ecc23580f4d2e3cc1ecfec25c50da4bc754dde6c8bfd8d1fc16956c74d8e9196046a01dc9f3024e11461c294f29d7421140732fedacac97b8fe50999117d27943c953f18c4ff4f8c258d839764078d4b6ef6e8591e0ff5563b31a39e6374d0d41c8c46921c25e5904a817ef8e39e5c9b71225a83269693e0b7e3218fc5e5a1e8412ba16e588b3d6ac536dce39fcdfce81eec79979ea6872793L</span></span><br><span class="line"><span class="comment">#e:  0x3</span></span><br><span class="line"><span class="comment">#c:0x10652cdfaa6b63f6d7bd1109da08181e500e5643f5b240a9024bfa84d5f2cac9310562978347bb232d63e7289283871efab83d84ff5a7b64a94a79d34cfbd4ef121723ba1f663e514f83f6f01492b4e13e1bb4296d96ea5a353d3bf2edd2f449c03c4a3e995237985a596908adc741f32365</span></span><br><span class="line">so,how to get the message?</span><br></pre></td></tr></table></figure>
<h4 id="分析-5">分析：</h4>
<p>可以发现e很小，而且代码中可以发现密文长度远小于n，则根据<span class="math inline">\(c\equiv m^e\pmod{n}\)</span> 可以发现模出来的数直接是明文的数学常数次方，直接对密文进行开方。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">　n=  <span class="number">0x52d483c27cd806550fbe0e37a61af2e7cf5e0efb723dfc81174c918a27627779b21fa3c851e9e94188eaee3d5cd6f752406a43fbecb53e80836ff1e185d3ccd7782ea846c2e91a7b0808986666e0bdadbfb7bdd65670a589a4d2478e9adcafe97c6ee23614bcb2ecc23580f4d2e3cc1ecfec25c50da4bc754dde6c8bfd8d1fc16956c74d8e9196046a01dc9f3024e11461c294f29d7421140732fedacac97b8fe50999117d27943c953f18c4ff4f8c258d839764078d4b6ef6e8591e0ff5563b31a39e6374d0d41c8c46921c25e5904a817ef8e39e5c9b71225a83269693e0b7e3218fc5e5a1e8412ba16e588b3d6ac536dce39fcdfce81eec79979ea6872793</span></span><br><span class="line">e=  <span class="number">0x3</span></span><br><span class="line">c=  <span class="number">0x10652cdfaa6b63f6d7bd1109da08181e500e5643f5b240a9024bfa84d5f2cac9310562978347bb232d63e7289283871efab83d84ff5a7b64a94a79d34cfbd4ef121723ba1f663e514f83f6f01492b4e13e1bb4296d96ea5a353d3bf2edd2f449c03c4a3e995237985a596908adc741f32365</span></span><br><span class="line">n= <span class="built_in">int</span>(n)</span><br><span class="line">e=<span class="built_in">int</span>(e)</span><br><span class="line">c=<span class="built_in">int</span>(c)</span><br><span class="line">m=gmpy2.iroot(c, <span class="number">3</span>)[<span class="number">0</span>]</span><br><span class="line">m = <span class="built_in">int</span>(m)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(m))</span><br></pre></td></tr></table></figure>
<h4 id="总结-3">总结：</h4>
<p>小明文的特征是密文的长度远小于n的长度，也就是<span class="math inline">\(m^e\)</span>模不过n，此时余数正是<span class="math inline">\(m^e\)</span>，也就是直接利用求根分解密文即可。</p>
<h3 id="no.7-共模攻击">NO.7 共模攻击</h3>
<p>BUU RSA :</p>
<h4 id="条件-2">条件：</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">c1=<span class="number">22322035275663237041646893770451933509324701913484303338076210603542612758956262869640822486470121149424485571361007421293675516338822195280313794991136048140918842471219840263536338886250492682739436410013436651161720725855484866690084788721349555662019879081501113222996123305533009325964377798892703161521852805956811219563883312896330156298621674684353919547558127920925706842808914762199011054955816534977675267395009575347820387073483928425066536361482774892370969520740304287456555508933372782327506569010772537497541764311429052216291198932092617792645253901478910801592878203564861118912045464959832566051361</span></span><br><span class="line">n=<span class="number">22708078815885011462462049064339185898712439277226831073457888403129378547350292420267016551819052430779004755846649044001024141485283286483130702616057274698473611149508798869706347501931583117632710700787228016480127677393649929530416598686027354216422565934459015161927613607902831542857977859612596282353679327773303727004407262197231586324599181983572622404590354084541788062262164510140605868122410388090174420147752408554129789760902300898046273909007852818474030770699647647363015102118956737673941354217692696044969695308506436573142565573487583507037356944848039864382339216266670673567488871508925311154801</span></span><br><span class="line">e1=<span class="number">11187289</span></span><br><span class="line">c2=<span class="number">18702010045187015556548691642394982835669262147230212731309938675226458555210425972429418449273410535387985931036711854265623905066805665751803269106880746769003478900791099590239513925449748814075904017471585572848473556490565450062664706449128415834787961947266259789785962922238701134079720414228414066193071495304612341052987455615930023536823801499269773357186087452747500840640419365011554421183037505653461286732740983702740822671148045619497667184586123657285604061875653909567822328914065337797733444640351518775487649819978262363617265797982843179630888729407238496650987720428708217115257989007867331698397</span></span><br><span class="line">e2=<span class="number">9647291</span></span><br></pre></td></tr></table></figure>
<h4 id="分析-6">分析：</h4>
<p>可以发现用了一个n加密，而且有两段密文，两个e的值最大公约数为1，可以用共模解题。</p>
<h4 id="推导过程修正逆元负指数幂">推导过程：(修正，逆元&amp;负指数幂)</h4>
<p>由于<span class="math inline">\(gcd(e1,e2)=1\)</span>,由欧几里得算法可知（修正）存在a,b使得<span class="math inline">\(a*e_1+b*e_2=1\)</span>成立，由已知可得到：</p>
<p><span class="math inline">\(c_1\equiv m^{e_1}\pmod{n}\)</span></p>
<p><span class="math inline">\(c_2\equiv m^{e_2}\pmod{n}\)</span></p>
<p>有模幂、模乘法运算：</p>
<p><span class="math inline">\((c_1^a*c_2^b)\equiv (m^{e_1}\pmod{n}^a*m^{e_2}\pmod{n}^b)\pmod{n}\)</span></p>
<p><span class="math inline">\((c_1^a*c_2^b)\equiv (m^{e_1*a}*m^{e_2*b})\pmod{n}\)</span></p>
<p><span class="math inline">\((c_1^a*c_2^b)\equiv m\pmod{n}\)</span></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">egcd</span>(<span class="params">a, b</span>):</span></span><br><span class="line">    <span class="keyword">if</span> a == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> (b, <span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        g, y, x = egcd(b % a, a)</span><br><span class="line">        <span class="keyword">return</span> (g, x - (b // a) * y, y)</span><br><span class="line">e1=<span class="number">11187289</span></span><br><span class="line">e2=<span class="number">9647291</span></span><br><span class="line">s = egcd(e1, e2)</span><br><span class="line">s1 = s[<span class="number">1</span>]</span><br><span class="line">s2 = s[<span class="number">2</span>]</span><br><span class="line"><span class="built_in">print</span>(s1,s2)</span><br><span class="line">m = <span class="built_in">pow</span>(c1,s1,n)*<span class="built_in">pow</span>(c2,s2,n) % n</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)))</span><br></pre></td></tr></table></figure>
<h3 id="no.8-openssl-rsa-kali-kali不好用就用聚焦terminal">NO.8 openssl &amp; rsa &amp; kali &amp; kali不好用就用聚焦Terminal</h3>
<p>BUU RSA :</p>
<p>题目给出一个名为flag.enc的文件和一个名为pub.key的文件。</p>
<p>思路：开始的时候笔者认为这依旧是改后缀能解决的问题，然而改完后缀和查看.enc 文件加密方式似乎并没有什么用处，打开虚拟机还用一个据说能打开enc后缀的文件发现并不是这样，直到搜到这种题型是有关<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/OpenSSL">openssl</a> 加密的方式生成加密后的文件和相关钥匙。</p>
<p>首先安装rsatool用于在终端中加密和解密，将下载到的文件（4个）复制到userpc中（<a target="_blank" rel="noopener" href="https://github.com/ius/rsatool">下载地址</a>），运行如下命令。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">python /Users/userpc/setup.py  install</span><br><span class="line">openssl rsa -pubin -<span class="keyword">in</span> pub.key -text -modulus  </span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">查看n和e的值，将modulus=的数据（HEX）转变为10进制数据</span></span><br><span class="line"><span class="string">将n的值在factordb.com分解得到两个大质数的值</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">python rsatool.py -o pub.key -e <span class="number">65537</span> -p <span class="number">285960468890451637935629440372639283459</span> -q <span class="number">304008741604601924494328155975272418463</span>  <span class="comment"># 生成私钥 ***.key -o后面的内容</span></span><br><span class="line">openssl rsautl -decrypt -<span class="keyword">in</span> flag.enc -inkey pub.key  </span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">导入 -inkey后面的内容（私钥）用于解密内容,运行命令得到旗帜（直接输出到终端）</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<h3 id="no.9-e与phin不互素">NO.9 e与<span class="math inline">\(\phi(n)\)</span>不互素</h3>
<p>BUU [NPUCTF2020]EzRSA :</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> lcm , powmod , invert , gcd , mpz</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> nextprime</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">n = p * q</span><br><span class="line">gift = lcm(p - <span class="number">1</span> , q - <span class="number">1</span>)</span><br><span class="line">e = <span class="number">54722</span></span><br><span class="line">flag = <span class="string">b&#x27;NPUCTF&#123;******************&#125;&#x27;</span></span><br><span class="line">m = <span class="built_in">int</span>.from_bytes(flag , <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line">c = powmod(m , e , n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;n: &#x27;</span> , n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;gift: &#x27;</span> , gift)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c: &#x27;</span> , c)</span><br><span class="line"></span><br><span class="line"><span class="comment">#n:  17083941230213489700426636484487738282426471494607098847295335339638177583685457921198569105417734668692072727759139358207667248703952436680183153327606147421932365889983347282046439156176685765143620637107347870401946946501620531665573668068349080410807996582297505889946205052879002028936125315312256470583622913646319779125559691270916064588684997382451412747432722966919513413709987353038375477178385125453567111965259721484997156799355617642131569095810304077131053588483057244340742751804935494087687363416921314041547093118565767609667033859583125275322077617576783247853718516166743858265291135353895239981121</span></span><br><span class="line"><span class="comment">#gift:  2135492653776686212553329560560967285303308936825887355911916917454772197960682240149821138177216833586509090969892419775958406087994054585022894165950768427741545736247918410255804894522085720642952579638418483800243368312702566458196708508543635051350999572787188236243275631609875253617015664414032058822919469443284453403064076232765024248435543326597418851751586308514540124571309152787559712950209357825576896132278045112177910266019741013995106579484868768251084453338417115483515132869594712162052362083414163954681306259137057581036657441897428432575924018950961141822554251369262248368899977337886190114104</span></span><br><span class="line"><span class="comment">#c:  3738960639194737957667684143565005503596276451617922474669745529299929395507971435311181578387223323429323286927370576955078618335757508161263585164126047545413028829873269342924092339298957635079736446851837414357757312525158356579607212496060244403765822636515347192211817658170822313646743520831977673861869637519843133863288550058359429455052676323196728280408508614527953057214779165450356577820378810467527006377296194102671360302059901897977339728292345132827184227155061326328585640019916328847372295754472832318258636054663091475801235050657401857262960415898483713074139212596685365780269667500271108538319</span></span><br></pre></td></tr></table></figure>
<h4 id="条件-3">条件：</h4>
<p>可以发现e的值是偶数，而gift的值也是偶数，lcm（）（Least Common Multiple）的作用为取两个数的最小公倍数，而由于p和q的来源可知，gift即为phi。由phi结尾为4，可知e与Phi不互素，无法直接求d。</p>
<p>根据公式：<span class="math inline">\(c\equiv m^e\pmod{n}\)</span> ,<span class="math inline">\(m\equiv c^d\pmod{n}\)</span>,<span class="math inline">\(e*d\equiv\pmod{\phi(n)}\)</span> .</p>
<p>由条件可知：</p>
<p><span class="math inline">\(gcd(e,phi)=b\)</span>,</p>
<p><span class="math inline">\(e=a*b\)</span>,</p>
<p><span class="math inline">\(a*b*d\equiv 1\pmod{\phi(n)}\)</span>,</p>
<p><span class="math inline">\(c\equiv m^{a*b}\pmod{n}\)</span></p>
<p><span class="math inline">\(m^{a*b*b*d}\equiv c^{b*d}\pmod{n}\)</span></p>
<p><span class="math inline">\(m^b\equiv c^{b*d}\pmod{n}\)</span><span class="math inline">\(\iff\)</span> 这里运用了费马小定理</p>
<p>最后根据b = 2，直接开方即可</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> math,libnum,gmpy2</span><br><span class="line">e = <span class="number">54722</span></span><br><span class="line">n = <span class="number">17083941230213489700426636484487738282426471494607098847295335339638177583685457921198569105417734668692072727759139358207667248703952436680183153327606147421932365889983347282046439156176685765143620637107347870401946946501620531665573668068349080410807996582297505889946205052879002028936125315312256470583622913646319779125559691270916064588684997382451412747432722966919513413709987353038375477178385125453567111965259721484997156799355617642131569095810304077131053588483057244340742751804935494087687363416921314041547093118565767609667033859583125275322077617576783247853718516166743858265291135353895239981121</span></span><br><span class="line">phi = <span class="number">2135492653776686212553329560560967285303308936825887355911916917454772197960682240149821138177216833586509090969892419775958406087994054585022894165950768427741545736247918410255804894522085720642952579638418483800243368312702566458196708508543635051350999572787188236243275631609875253617015664414032058822919469443284453403064076232765024248435543326597418851751586308514540124571309152787559712950209357825576896132278045112177910266019741013995106579484868768251084453338417115483515132869594712162052362083414163954681306259137057581036657441897428432575924018950961141822554251369262248368899977337886190114104</span></span><br><span class="line">c = <span class="number">3738960639194737957667684143565005503596276451617922474669745529299929395507971435311181578387223323429323286927370576955078618335757508161263585164126047545413028829873269342924092339298957635079736446851837414357757312525158356579607212496060244403765822636515347192211817658170822313646743520831977673861869637519843133863288550058359429455052676323196728280408508614527953057214779165450356577820378810467527006377296194102671360302059901897977339728292345132827184227155061326328585640019916328847372295754472832318258636054663091475801235050657401857262960415898483713074139212596685365780269667500271108538319</span></span><br><span class="line">b = math.gcd(e,phi)</span><br><span class="line">a = e//b</span><br><span class="line">d = gmpy2.invert(a,phi)</span><br><span class="line">d = <span class="built_in">int</span>(d)</span><br><span class="line">d = b*d</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line">m = <span class="built_in">int</span>(m)</span><br><span class="line">m = gmpy2.iroot(m,<span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line"><span class="keyword">if</span> gmpy2.iroot(m,<span class="number">2</span>)[<span class="number">1</span>] == <span class="number">1</span>:  <span class="comment"># 开n次方得出的是一个两个数据的数组</span></span><br><span class="line">    flag = gmpy2.iroot(m,<span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line">    flag = <span class="built_in">int</span>(flag)</span><br><span class="line">    <span class="built_in">print</span>(libnum.n2s(flag))</span><br></pre></td></tr></table></figure>
<h3 id="no.10-crt正则表达式">NO.10 CRT&amp;正则表达式</h3>
<p>BUU RSA5 :</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">m = xxxxxxxx</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">========== n c ==========</span><br><span class="line">n = <span class="number">20474918894051778533305262345601880928088284471121823754049725354072477155873778848055073843345820697886641086842612486541250183965966001591342031562953561793332341641334302847996108417466360688139866505179689516589305636902137210185624650854906780037204412206309949199080005576922775773722438863762117750429327585792093447423980002401200613302943834212820909269713876683465817369158585822294675056978970612202885426436071950214538262921077409076160417436699836138801162621314845608796870206834704116707763169847387223307828908570944984416973019427529790029089766264949078038669523465243837675263858062854739083634207</span></span><br><span class="line">c = <span class="number">974463908243330865728978769213595400782053398596897741316275722596415018912929508637393850919224969271766388710025195039896961956062895570062146947736340342927974992616678893372744261954172873490878805483241196345881721164078651156067119957816422768524442025688079462656755605982104174001635345874022133045402344010045961111720151990412034477755851802769069309069018738541854130183692204758761427121279982002993939745343695671900015296790637464880337375511536424796890996526681200633086841036320395847725935744757993013352804650575068136129295591306569213300156333650910795946800820067494143364885842896291126137320</span></span><br><span class="line"></span><br><span class="line">n = <span class="number">20918819960648891349438263046954902210959146407860980742165930253781318759285692492511475263234242002509419079545644051755251311392635763412553499744506421566074721268822337321637265942226790343839856182100575539845358877493718334237585821263388181126545189723429262149630651289446553402190531135520836104217160268349688525168375213462570213612845898989694324269410202496871688649978370284661017399056903931840656757330859626183773396574056413017367606446540199973155630466239453637232936904063706551160650295031273385619470740593510267285957905801566362502262757750629162937373721291789527659531499435235261620309759</span></span><br><span class="line">c = <span class="number">15819636201971185538694880505120469332582151856714070824521803121848292387556864177196229718923770810072104155432038682511434979353089791861087415144087855679134383396897817458726543883093567600325204596156649305930352575274039425470836355002691145864435755333821133969266951545158052745938252574301327696822347115053614052423028835532509220641378760800693351542633860702225772638930501021571415907348128269681224178300248272689705308911282208685459668200507057183420662959113956077584781737983254788703048275698921427029884282557468334399677849962342196140864403989162117738206246183665814938783122909930082802031855</span></span><br><span class="line"></span><br><span class="line">n = <span class="number">25033254625906757272369609119214202033162128625171246436639570615263949157363273213121556825878737923265290579551873824374870957467163989542063489416636713654642486717219231225074115269684119428086352535471683359486248203644461465935500517901513233739152882943010177276545128308412934555830087776128355125932914846459470221102007666912211992310538890654396487111705385730502843589727289829692152177134753098649781412247065660637826282055169991824099110916576856188876975621376606634258927784025787142263367152947108720757222446686415627479703666031871635656314282727051189190889008763055811680040315277078928068816491</span></span><br><span class="line">c = <span class="number">4185308529416874005831230781014092407198451385955677399668501833902623478395669279404883990725184332709152443372583701076198786635291739356770857286702107156730020004358955622511061410661058982622055199736820808203841446796305284394651714430918690389486920560834672316158146453183789412140939029029324756035358081754426645160033262924330248675216108270980157049705488620263485129480952814764002865280019185127662449318324279383277766416258142275143923532168798413011028271543085249029048997452212503111742302302065401051458066585395360468447460658672952851643547193822775218387853623453638025492389122204507555908862</span></span><br><span class="line"></span><br><span class="line">n = <span class="number">21206968097314131007183427944486801953583151151443627943113736996776787181111063957960698092696800555044199156765677935373149598221184792286812213294617749834607696302116136745662816658117055427803315230042700695125718401646810484873064775005221089174056824724922160855810527236751389605017579545235876864998419873065217294820244730785120525126565815560229001887622837549118168081685183371092395128598125004730268910276024806808565802081366898904032509920453785997056150497645234925528883879419642189109649009132381586673390027614766605038951015853086721168018787523459264932165046816881682774229243688581614306480751</span></span><br><span class="line">c = <span class="number">4521038011044758441891128468467233088493885750850588985708519911154778090597136126150289041893454126674468141393472662337350361712212694867311622970440707727941113263832357173141775855227973742571088974593476302084111770625764222838366277559560887042948859892138551472680654517814916609279748365580610712259856677740518477086531592233107175470068291903607505799432931989663707477017904611426213770238397005743730386080031955694158466558475599751940245039167629126576784024482348452868313417471542956778285567779435940267140679906686531862467627238401003459101637191297209422470388121802536569761414457618258343550613</span></span><br><span class="line"></span><br><span class="line">n = <span class="number">22822039733049388110936778173014765663663303811791283234361230649775805923902173438553927805407463106104699773994158375704033093471761387799852168337898526980521753614307899669015931387819927421875316304591521901592823814417756447695701045846773508629371397013053684553042185725059996791532391626429712416994990889693732805181947970071429309599614973772736556299404246424791660679253884940021728846906344198854779191951739719342908761330661910477119933428550774242910420952496929605686154799487839923424336353747442153571678064520763149793294360787821751703543288696726923909670396821551053048035619499706391118145067</span></span><br><span class="line">c = <span class="number">15406498580761780108625891878008526815145372096234083936681442225155097299264808624358826686906535594853622687379268969468433072388149786607395396424104318820879443743112358706546753935215756078345959375299650718555759698887852318017597503074317356745122514481807843745626429797861463012940172797612589031686718185390345389295851075279278516147076602270178540690147808314172798987497259330037810328523464851895621851859027823681655934104713689539848047163088666896473665500158179046196538210778897730209572708430067658411755959866033531700460551556380993982706171848970460224304996455600503982223448904878212849412357</span></span><br><span class="line"></span><br><span class="line">n = <span class="number">21574139855341432908474064784318462018475296809327285532337706940126942575349507668289214078026102682252713757703081553093108823214063791518482289846780197329821139507974763780260290309600884920811959842925540583967085670848765317877441480914852329276375776405689784571404635852204097622600656222714808541872252335877037561388406257181715278766652824786376262249274960467193961956690974853679795249158751078422296580367506219719738762159965958877806187461070689071290948181949561254144310776943334859775121650186245846031720507944987838489723127897223416802436021278671237227993686791944711422345000479751187704426369</span></span><br><span class="line">c = <span class="number">20366856150710305124583065375297661819795242238376485264951185336996083744604593418983336285185491197426018595031444652123288461491879021096028203694136683203441692987069563513026001861435722117985559909692670907347563594578265880806540396777223906955491026286843168637367593400342814725694366078337030937104035993569672959361347287894143027186846856772983058328919716702982222142848848117768499996617588305301483085428547267337070998767412540225911508196842253134355901263861121500650240296746702967594224401650220168780537141654489215019142122284308116284129004257364769474080721001708734051264841350424152506027932</span></span><br><span class="line"></span><br><span class="line">n = <span class="number">25360227412666612490102161131174584819240931803196448481224305250583841439581008528535930814167338381983764991296575637231916547647970573758269411168219302370541684789125112505021148506809643081950237623703181025696585998044695691322012183660424636496897073045557400768745943787342548267386564625462143150176113656264450210023925571945961405709276631990731602198104287528528055650050486159837612279600415259486306154947514005408907590083747758953115486124865486720633820559135063440942528031402951958557630833503775112010715604278114325528993771081233535247118481765852273252404963430792898948219539473312462979849137</span></span><br><span class="line">c = <span class="number">19892772524651452341027595619482734356243435671592398172680379981502759695784087900669089919987705675899945658648623800090272599154590123082189645021800958076861518397325439521139995652026377132368232502108620033400051346127757698623886142621793423225749240286511666556091787851683978017506983310073524398287279737680091787333547538239920607761080988243639547570818363788673249582783015475682109984715293163137324439862838574460108793714172603672477766831356411304446881998674779501188163600664488032943639694828698984739492200699684462748922883550002652913518229322945040819064133350314536378694523704793396169065179</span></span><br><span class="line"></span><br><span class="line">n = <span class="number">22726855244632356029159691753451822163331519237547639938779517751496498713174588935566576167329576494790219360727877166074136496129927296296996970048082870488804456564986667129388136556137013346228118981936899510687589585286517151323048293150257036847475424044378109168179412287889340596394755257704938006162677656581509375471102546261355748251869048003600520034656264521931808651038524134185732929570384705918563982065684145766427962502261522481994191989820110575981906998431553107525542001187655703534683231777988419268338249547641335718393312295800044734534761692799403469497954062897856299031257454735945867491191</span></span><br><span class="line">c = <span class="number">6040119795175856407541082360023532204614723858688636724822712717572759793960246341800308149739809871234313049629732934797569781053000686185666374833978403290525072598774001731350244744590772795701065129561898116576499984185920661271123665356132719193665474235596884239108030605882777868856122378222681140570519180321286976947154042272622411303981011302586225630859892731724640574658125478287115198406253847367979883768000812605395482952698689604477719478947595442185921480652637868335673233200662100621025061500895729605305665864693122952557361871523165300206070325660353095592778037767395360329231331322823610060006</span></span><br><span class="line"></span><br><span class="line">n = <span class="number">23297333791443053297363000786835336095252290818461950054542658327484507406594632785712767459958917943095522594228205423428207345128899745800927319147257669773812669542782839237744305180098276578841929496345963997512244219376701787616046235397139381894837435562662591060768476997333538748065294033141610502252325292801816812268934171361934399951548627267791401089703937389012586581080223313060159456238857080740699528666411303029934807011214953984169785844714159627792016926490955282697877141614638806397689306795328344778478692084754216753425842557818899467945102646776342655167655384224860504086083147841252232760941</span></span><br><span class="line">c = <span class="number">5418120301208378713115889465579964257871814114515046096090960159737859076829258516920361577853903925954198406843757303687557848302302200229295916902430205737843601806700738234756698575708612424928480440868739120075888681672062206529156566421276611107802917418993625029690627196813830326369874249777619239603300605876865967515719079797115910578653562787899019310139945904958024882417833736304894765433489476234575356755275147256577387022873348906900149634940747104513850154118106991137072643308620284663108283052245750945228995387803432128842152251549292698947407663643895853432650029352092018372834457054271102816934</span></span><br><span class="line"></span><br><span class="line">n = <span class="number">28873667904715682722987234293493200306976947898711255064125115933666968678742598858722431426218914462903521596341771131695619382266194233561677824357379805303885993804266436810606263022097900266975250431575654686915049693091467864820512767070713267708993899899011156106766178906700336111712803362113039613548672937053397875663144794018087017731949087794894903737682383916173267421403408140967713071026001874733487295007501068871044649170615709891451856792232315526696220161842742664778581287321318748202431466508948902745314372299799561625186955234673012098210919745879882268512656931714326782335211089576897310591491</span></span><br><span class="line">c = <span class="number">9919880463786836684987957979091527477471444996392375244075527841865509160181666543016317634963512437510324198702416322841377489417029572388474450075801462996825244657530286107428186354172836716502817609070590929769261932324275353289939302536440310628698349244872064005700644520223727670950787924296004296883032978941200883362653993351638545860207179022472492671256630427228461852668118035317021428675954874947015197745916918197725121122236369382741533983023462255913924692806249387449016629865823316402366017657844166919846683497851842388058283856219900535567427103603869955066193425501385255322097901531402103883869</span></span><br><span class="line"></span><br><span class="line">n = <span class="number">22324685947539653722499932469409607533065419157347813961958075689047690465266404384199483683908594787312445528159635527833904475801890381455653807265501217328757871352731293000303438205315816792663917579066674842307743845261771032363928568844669895768092515658328756229245837025261744260614860746997931503548788509983868038349720225305730985576293675269073709022350700836510054067641753713212999954307022524495885583361707378513742162566339010134354907863733205921845038918224463903789841881400814074587261720283879760122070901466517118265422863420376921536734845502100251460872499122236686832189549698020737176683019</span></span><br><span class="line">c = <span class="number">1491527050203294989882829248560395184804977277747126143103957219164624187528441047837351263580440686474767380464005540264627910126483129930668344095814547592115061057843470131498075060420395111008619027199037019925701236660166563068245683975787762804359520164701691690916482591026138582705558246869496162759780878437137960823000043988227303003876410503121370163303711603359430764539337597866862508451528158285103251810058741879687875218384160282506172706613359477657215420734816049393339593755489218588796607060261897905233453268671411610631047340459487937479511933450369462213795738933019001471803157607791738538467</span></span><br><span class="line"></span><br><span class="line">n = <span class="number">27646746423759020111007828653264027999257847645666129907789026054594393648800236117046769112762641778865620892443423100189619327585811384883515424918752749559627553637785037359639801125213256163008431942593727931931898199727552768626775618479833029101249692573716030706695702510982283555740851047022672485743432464647772882314215176114732257497240284164016914018689044557218920300262234652840632406067273375269301008409860193180822366735877288205783314326102263756503786736122321348320031950012144905869556204017430593656052867939493633163499580242224763404338807022510136217187779084917996171602737036564991036724299</span></span><br><span class="line">c = <span class="number">21991524128957260536043771284854920393105808126700128222125856775506885721971193109361315961129190814674647136464887087893990660894961612838205086401018885457667488911898654270235561980111174603323721280911197488286585269356849579263043456316319476495888696219344219866516861187654180509247881251251278919346267129904739277386289240394384575124331135655943513831009934023397457082184699737734388823763306805326430395849935770213817533387235486307008892410920611669932693018165569417445885810825749609388627231235840912644654685819620931663346297596334834498661789016450371769203650109994771872404185770230172934013971</span></span><br><span class="line"></span><br><span class="line">n = <span class="number">20545487405816928731738988374475012686827933709789784391855706835136270270933401203019329136937650878386117187776530639342572123237188053978622697282521473917978282830432161153221216194169879669541998840691383025487220850872075436064308499924958517979727954402965612196081404341651517326364041519250125036424822634354268773895465698920883439222996581226358595873993976604699830613932320720554130011671297944433515047180565484495191003887599891289037982010216357831078328159028953222056918189365840711588671093333013117454034313622855082795813122338562446223041211192277089225078324682108033843023903550172891959673551</span></span><br><span class="line">c = <span class="number">14227439188191029461250476692790539654619199888487319429114414557975376308688908028140817157205579804059783807641305577385724758530138514972962209062230576107406142402603484375626077345190883094097636019771377866339531511965136650567412363889183159616188449263752475328663245311059988337996047359263288837436305588848044572937759424466586870280512424336807064729894515840552404756879590698797046333336445465120445087587621743906624279621779634772378802959109714400516183718323267273824736540168545946444437586299214110424738159957388350785999348535171553569373088251552712391288365295267665691357719616011613628772175</span></span><br><span class="line"></span><br><span class="line">n = <span class="number">27359727711584277234897157724055852794019216845229798938655814269460046384353568138598567755392559653460949444557879120040796798142218939251844762461270251672399546774067275348291003962551964648742053215424620256999345448398805278592777049668281558312871773979931343097806878701114056030041506690476954254006592555275342579529625231194321357904668512121539514880704046969974898412095675082585315458267591016734924646294357666924293908418345508902112711075232047998775303603175363964055048589769318562104883659754974955561725694779754279606726358588862479198815999276839234952142017210593887371950645418417355912567987</span></span><br><span class="line">c = <span class="number">3788529784248255027081674540877016372807848222776887920453488878247137930578296797437647922494510483767651150492933356093288965943741570268943861987024276610712717409139946409513963043114463933146088430004237747163422802959250296602570649363016151581364006795894226599584708072582696996740518887606785460775851029814280359385763091078902301957226484620428513604630585131511167015763190591225884202772840456563643159507805711004113901417503751181050823638207803533111429510911616160851391754754434764819568054850823810901159821297849790005646102129354035735350124476838786661542089045509656910348676742844957008857457</span></span><br><span class="line"></span><br><span class="line">n = <span class="number">27545937603751737248785220891735796468973329738076209144079921449967292572349424539010502287564030116831261268197384650511043068738911429169730640135947800885987171539267214611907687570587001933829208655100828045651391618089603288456570334500533178695238407684702251252671579371018651675054368606282524673369983034682330578308769886456335818733827237294570476853673552685361689144261552895758266522393004116017849397346259119221063821663280935820440671825601452417487330105280889520007917979115568067161590058277418371493228631232457972494285014767469893647892888681433965857496916110704944758070268626897045014782837</span></span><br><span class="line">c = <span class="number">14069112970608895732417039977542732665796601893762401500878786871680645798754783315693511261740059725171342404186571066972546332813667711135661176659424619936101038903439144294886379322591635766682645179888058617577572409307484708171144488708410543462972008179994594087473935638026612679389759756811490524127195628741262871304427908481214992471182859308828778119005750928935764927967212343526503410515793717201360360437981322576798056276657140363332700714732224848346808963992302409037706094588964170239521193589470070839790404597252990818583717869140229811712295005710540476356743378906642267045723633874011649259842</span></span><br><span class="line"></span><br><span class="line">n = <span class="number">25746162075697911560263181791216433062574178572424600336856278176112733054431463253903433128232709054141607100891177804285813783247735063753406524678030561284491481221681954564804141454666928657549670266775659862814924386584148785453647316864935942772919140563506305666207816897601862713092809234429096584753263707828899780979223118181009293655563146526792388913462557306433664296966331469906428665127438829399703002867800269947855869262036714256550075520193125987011945192273531732276641728008406855871598678936585324782438668746810516660152018244253008092470066555687277138937298747951929576231036251316270602513451</span></span><br><span class="line">c = <span class="number">17344284860275489477491525819922855326792275128719709401292545608122859829827462088390044612234967551682879954301458425842831995513832410355328065562098763660326163262033200347338773439095709944202252494552172589503915965931524326523663289777583152664722241920800537867331030623906674081852296232306336271542832728410803631170229642717524942332390842467035143631504401140727083270732464237443915263865880580308776111219718961746378842924644142127243573824972533819479079381023103585862099063382129757560124074676150622288706094110075567706403442920696472627797607697962873026112240527498308535903232663939028587036724</span></span><br><span class="line"></span><br><span class="line">n = <span class="number">23288486934117120315036919418588136227028485494137930196323715336208849327833965693894670567217971727921243839129969128783853015760155446770590696037582684845937132790047363216362087277861336964760890214059732779383020349204803205725870225429985939570141508220041286857810048164696707018663758416807708910671477407366098883430811861933014973409390179948577712579749352299440310543689035651465399867908428885541237776143404376333442949397063249223702355051571790555151203866821867908531733788784978667478707672984539512431549558672467752712004519300318999208102076732501412589104904734983789895358753664077486894529499</span></span><br><span class="line">c = <span class="number">10738254418114076548071448844964046468141621740603214384986354189105236977071001429271560636428075970459890958274941762528116445171161040040833357876134689749846940052619392750394683504816081193432350669452446113285638982551762586656329109007214019944975816434827768882704630460001209452239162896576191876324662333153835533956600295255158377025198426950944040643235430211011063586032467724329735785947372051759042138171054165854842472990583800899984893232549092766400510300083585513014171220423103452292891496141806956300396540682381668367564569427813092064053993103537635994311143010708814851867239706492577203899024</span></span><br><span class="line"></span><br><span class="line">n = <span class="number">19591441383958529435598729113936346657001352578357909347657257239777540424811749817783061233235817916560689138344041497732749011519736303038986277394036718790971374656832741054547056417771501234494768509780369075443550907847298246275717420562375114406055733620258777905222169702036494045086017381084272496162770259955811174440490126514747876661317750649488774992348005044389081101686016446219264069971370646319546429782904810063020324704138495608761532563310699753322444871060383693044481932265801505819646998535192083036872551683405766123968487907648980900712118052346174533513978009131757167547595857552370586353973</span></span><br><span class="line">c = <span class="number">3834917098887202931981968704659119341624432294759361919553937551053499607440333234018189141970246302299385742548278589896033282894981200353270637127213483172182529890495903425649116755901631101665876301799865612717750360089085179142750664603454193642053016384714515855868368723508922271767190285521137785688075622832924829248362774476456232826885801046969384519549385428259591566716890844604696258783639390854153039329480726205147199247183621535172450825979047132495439603840806501254997167051142427157381799890725323765558803808030109468048682252028720241357478614704610089120810367192414352034177484688502364022887</span></span><br><span class="line"></span><br><span class="line">n = <span class="number">19254242571588430171308191757871261075358521158624745702744057556054652332495961196795369630484782930292003238730267396462491733557715379956969694238267908985251699834707734400775311452868924330866502429576951934279223234676654749272932769107390976321208605516299532560054081301829440688796904635446986081691156842271268059970762004259219036753174909942343204432795076377432107630203621754552804124408792358220071862369443201584155711893388877350138023238624566616551246804054720492816226651467017802504094070614892556444425915920269485861799532473383304622064493223627552558344088839860178294589481899206318863310603</span></span><br><span class="line">c = <span class="number">6790553533991297205804561991225493105312398825187682250780197510784765226429663284220400480563039341938599783346724051076211265663468643826430109013245014035811178295081939958687087477312867720289964506097819762095244479129359998867671811819738196687884696680463458661374310994610760009474264115750204920875527434486437536623589684519411519100170291423367424938566820315486507444202022408003879118465761273916755290898112991525546114191064022991329724370064632569903856189236177894007766690782630247443895358893983735822824243487181851098787271270256780891094405121947631088729917398317652320497765101790132679171889</span></span><br><span class="line"></span><br><span class="line">n = <span class="number">26809700251171279102974962949184411136459372267620535198421449833298448092580497485301953796619185339316064387798092220298630428207556482805739803420279056191194360049651767412572609187680508073074653291350998253938793269214230457117194434853888765303403385824786231859450351212449404870776320297419712486574804794325602760347306432927281716160368830187944940128907971027838510079519466846176106565164730963988892400240063089397720414921398936399927948235195085202171264728816184532651138221862240969655185596628285814057082448321749567943946273776184657698104465062749244327092588237927996419620170254423837876806659</span></span><br><span class="line">c = <span class="number">386213556608434013769864727123879412041991271528990528548507451210692618986652870424632219424601677524265011043146748309774067894985069288067952546139416819404039688454756044862784630882833496090822568580572859029800646671301748901528132153712913301179254879877441322285914544974519727307311002330350534857867516466612474769753577858660075830592891403551867246057397839688329172530177187042229028685862036140779065771061933528137423019407311473581832405899089709251747002788032002094495379614686544672969073249309703482556386024622814731015767810042969813752548617464974915714425595351940266077021672409858645427346</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="分析-7">分析：</h4>
<p>可以发现给了很多组（n,c）的数据对，而e = 65537。根据公式<span class="math inline">\(c\equiv m^e\pmod{n}\)</span>,可以发现数据可以看作<span class="math inline">\(c_i\equiv m^e\pmod{n_i}\)</span>的形式，也就是组成了形式为<span class="math inline">\(x\equiv a_i\pmod{m_i}\)</span>的同余方程组，所以本题需要在提取正常数据的同时用中国剩余定理解题。（Python正则表达式+CRT）</p>
<p>然而事情并不简单，由于需要求解逆元，而逆元的存在前提是（a,b）=1,在若干组数据中，仅有三组数据是符合以上情况，所以需要形成新的数据对求解旗帜。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re,os</span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;/Users/userpc/Desktop/1.txt&#x27;</span>,<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">content = f.read()</span><br><span class="line">Group_n = re.findall(<span class="string">r&#x27;[n][\W][=][\W][0-9]*[\n]&#x27;</span>,content,re.M)</span><br><span class="line">Group_c = re.findall(<span class="string">r&#x27;[c][\W][=][\W][0-9]*[\n]&#x27;</span>,content,re.M)</span><br><span class="line"><span class="comment">#print(Group_n)</span></span><br><span class="line"><span class="comment">#print(Group_c)</span></span><br><span class="line">new_n =[]</span><br><span class="line">new_c =[]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> Group_n:</span><br><span class="line">    i=<span class="built_in">int</span>(i[<span class="number">3</span>:][:-<span class="number">3</span>])</span><br><span class="line">    new_n.append(i)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> Group_c:</span><br><span class="line">    i=<span class="built_in">int</span>(i[<span class="number">3</span>:][:-<span class="number">3</span>])</span><br><span class="line">    new_c.append(i)</span><br><span class="line"><span class="built_in">print</span>(new_c)</span><br><span class="line"><span class="built_in">print</span>(new_n)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">CRT_decode</span>(<span class="params">m_i,b_i</span>):</span></span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">len</span>(m_i) == <span class="built_in">len</span>(b_i)</span><br><span class="line">    </span><br><span class="line"><span class="comment">#print(content)</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><u>然而上面的思路是错误的</u> 晕了两周。。。</p>
<p>虽然使用CRT也可以但是需要大量的运算，在偶然看到wp提及到最大公约数的方法，深感数学太差的无力。不过最终还是找到了最大公约数将题目解了出来，这里仍然是利用了正则表达式，还有随机抽取列表中的元素进行比较最大公约数。（这里实在是没办法，由于编程能力太差只能选择了手动随机选取p）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re,os,gmpy2,math</span><br><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> reduce</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> sample</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">r&#x27;C:\Users\ug\Desktop\1.txt&#x27;</span>,<span class="string">&#x27;r+&#x27;</span>)</span><br><span class="line">t = f.read()</span><br><span class="line">groupn = re.findall(<span class="string">r&#x27;^[n][ ]=[ ][0-9]+&#x27;</span>,t,re.M)</span><br><span class="line">groupc = re.findall(<span class="string">r&#x27;^[c][ ]=[ ][0-9]+&#x27;</span>,t,re.M)</span><br><span class="line"></span><br><span class="line">gn = []</span><br><span class="line">gc = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(groupn)):</span><br><span class="line">        i = groupn[i][<span class="number">4</span>:]</span><br><span class="line">        gn.append(i)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(groupc)):</span><br><span class="line">        i = groupc[i][<span class="number">4</span>:]</span><br><span class="line">        gc.append(i)</span><br><span class="line"><span class="built_in">print</span>(gn)</span><br><span class="line">ai = []</span><br><span class="line">mi = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(groupn)):</span><br><span class="line">    gc[i] = <span class="built_in">int</span>(gc[i])</span><br><span class="line">    gn[i] = <span class="built_in">int</span>(gn[i])</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(gn)):</span><br><span class="line">    gcd = sample(gn,<span class="number">2</span>)</span><br><span class="line">    p = math.gcd(gcd[<span class="number">0</span>], gcd[<span class="number">1</span>])</span><br><span class="line">    <span class="keyword">if</span> p != <span class="number">1</span>:</span><br><span class="line">        <span class="built_in">print</span>(p,gcd[<span class="number">0</span>],gcd[<span class="number">1</span>])</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n1 = <span class="number">22822039733049388110936778173014765663663303811791283234361230649775805923902173438553927805407463106104699773994158375704033093471761387799852168337898526980521753614307899669015931387819927421875316304591521901592823814417756447695701045846773508629371397013053684553042185725059996791532391626429712416994990889693732805181947970071429309599614973772736556299404246424791660679253884940021728846906344198854779191951739719342908761330661910477119933428550774242910420952496929605686154799487839923424336353747442153571678064520763149793294360787821751703543288696726923909670396821551053048035619499706391118145067</span></span><br><span class="line">p1 = <span class="number">132585806383798600305426957307612567604223562626764190211333136246643723811046149337852966828729052476725552361132437370521548707664977123165279305052971868012755509160408641100548744046621516877981864180076497524093201404558036301820216274968638825245150755772559259575544101918590311068466601618472464832499</span></span><br><span class="line">q1 = n1//p1</span><br><span class="line">phi = (p1-<span class="number">1</span>)*(q1-<span class="number">1</span>)</span><br><span class="line">c = <span class="number">15406498580761780108625891878008526815145372096234083936681442225155097299264808624358826686906535594853622687379268969468433072388149786607395396424104318820879443743112358706546753935215756078345959375299650718555759698887852318017597503074317356745122514481807843745626429797861463012940172797612589031686718185390345389295851075279278516147076602270178540690147808314172798987497259330037810328523464851895621851859027823681655934104713689539848047163088666896473665500158179046196538210778897730209572708430067658411755959866033531700460551556380993982706171848970460224304996455600503982223448904878212849412357</span></span><br><span class="line">d = gmpy2.invert(e,phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n1)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)))</span><br></pre></td></tr></table></figure>
<h3 id="no.11-导数和rsa">NO.11 导数和RSA</h3>
<p>BUU [BJDCTF2020]easyrsa :</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime,bytes_to_long</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> Derivative</span><br><span class="line"><span class="keyword">from</span> fractions <span class="keyword">import</span> Fraction</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p=getPrime(<span class="number">1024</span>)</span><br><span class="line">q=getPrime(<span class="number">1024</span>)</span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">n=p*q</span><br><span class="line">z=Fraction(<span class="number">1</span>,Derivative(arctan(p),p))-Fraction(<span class="number">1</span>,Derivative(arth(q),q))</span><br><span class="line">m=bytes_to_long(flag)</span><br><span class="line">c=<span class="built_in">pow</span>(m,e,n)</span><br><span class="line"><span class="built_in">print</span>(c,z,n)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">c = <span class="number">7922547866857761459807491502654216283012776177789511549350672958101810281348402284098310147796549430689253803510994877420135537268549410652654479620858691324110367182025648788407041599943091386227543182157746202947099572389676084392706406084307657000104665696654409155006313203957292885743791715198781974205578654792123191584957665293208390453748369182333152809882312453359706147808198922916762773721726681588977103877454119043744889164529383188077499194932909643918696646876907327364751380953182517883134591810800848971719184808713694342985458103006676013451912221080252735948993692674899399826084848622145815461035</span></span><br><span class="line">z = <span class="number">32115748677623209667471622872185275070257924766015020072805267359839059393284316595882933372289732127274076434587519333300142473010344694803885168557548801202495933226215437763329280242113556524498457559562872900811602056944423967403777623306961880757613246328729616643032628964072931272085866928045973799374711846825157781056965164178505232524245809179235607571567174228822561697888645968559343608375331988097157145264357626738141646556353500994924115875748198318036296898604097000938272195903056733565880150540275369239637793975923329598716003350308259321436752579291000355560431542229699759955141152914708362494482</span></span><br><span class="line">n = <span class="number">15310745161336895413406690009324766200789179248896951942047235448901612351128459309145825547569298479821101249094161867207686537607047447968708758990950136380924747359052570549594098569970632854351825950729752563502284849263730127586382522703959893392329333760927637353052250274195821469023401443841395096410231843592101426591882573405934188675124326997277775238287928403743324297705151732524641213516306585297722190780088180705070359469719869343939106529204798285957516860774384001892777525916167743272419958572055332232056095979448155082465977781482598371994798871917514767508394730447974770329967681767625495394441</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="分析-8">分析：</h4>
<p>根据代码可以发现其中涉及了两个函数分别是导数和分数，由z的形成过程，可以得到z的值为<span class="math inline">\(p^2+q^2\)</span>,则由<span class="math inline">\(n=p*q\)</span> ，根据完全平方公式可以求出两个大素数的和。当然本题目直接分解也可以。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2,libnum,math</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="number">7922547866857761459807491502654216283012776177789511549350672958101810281348402284098310147796549430689253803510994877420135537268549410652654479620858691324110367182025648788407041599943091386227543182157746202947099572389676084392706406084307657000104665696654409155006313203957292885743791715198781974205578654792123191584957665293208390453748369182333152809882312453359706147808198922916762773721726681588977103877454119043744889164529383188077499194932909643918696646876907327364751380953182517883134591810800848971719184808713694342985458103006676013451912221080252735948993692674899399826084848622145815461035</span></span><br><span class="line">z = <span class="number">32115748677623209667471622872185275070257924766015020072805267359839059393284316595882933372289732127274076434587519333300142473010344694803885168557548801202495933226215437763329280242113556524498457559562872900811602056944423967403777623306961880757613246328729616643032628964072931272085866928045973799374711846825157781056965164178505232524245809179235607571567174228822561697888645968559343608375331988097157145264357626738141646556353500994924115875748198318036296898604097000938272195903056733565880150540275369239637793975923329598716003350308259321436752579291000355560431542229699759955141152914708362494482</span></span><br><span class="line">n = <span class="number">15310745161336895413406690009324766200789179248896951942047235448901612351128459309145825547569298479821101249094161867207686537607047447968708758990950136380924747359052570549594098569970632854351825950729752563502284849263730127586382522703959893392329333760927637353052250274195821469023401443841395096410231843592101426591882573405934188675124326997277775238287928403743324297705151732524641213516306585297722190780088180705070359469719869343939106529204798285957516860774384001892777525916167743272419958572055332232056095979448155082465977781482598371994798871917514767508394730447974770329967681767625495394441</span></span><br><span class="line">plus = z+<span class="number">2</span>*n</span><br><span class="line">p_q = gmpy2.iroot(plus,<span class="number">2</span>)</span><br><span class="line">pq = p_q[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(pq)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,pq):</span><br><span class="line">    p , q = i , pq - i</span><br><span class="line">    <span class="keyword">if</span> n//i == q:</span><br><span class="line">        <span class="built_in">print</span>(p,q)</span><br></pre></td></tr></table></figure>
<h3 id="no.12-立方和差公式-yafu-拼接-sympy">NO.12 立方和差公式 yafu 拼接 sympy</h3>
<p>BUU [GWCTF 2019]BabyRSA:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> sympy</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;GWHT&#123;******&#125;&#x27;</span></span><br><span class="line">secret = <span class="string">&#x27;******&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span>(<span class="built_in">len</span>(flag) == <span class="number">38</span>)</span><br><span class="line"></span><br><span class="line">half = <span class="built_in">len</span>(flag) / <span class="number">2</span></span><br><span class="line"></span><br><span class="line">flag1 = flag[:half]</span><br><span class="line">flag2 = flag[half:]</span><br><span class="line"></span><br><span class="line">secret_num = getPrime(<span class="number">1024</span>) * bytes_to_long(secret)</span><br><span class="line"></span><br><span class="line">p = sympy.nextprime(secret_num)</span><br><span class="line">q = sympy.nextprime(p)</span><br><span class="line"></span><br><span class="line">N = p * q</span><br><span class="line"></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line"></span><br><span class="line">F1 = bytes_to_long(flag1)</span><br><span class="line">F2 = bytes_to_long(flag2)</span><br><span class="line"></span><br><span class="line">c1 = F1 + F2</span><br><span class="line">c2 = <span class="built_in">pow</span>(F1, <span class="number">3</span>) + <span class="built_in">pow</span>(F2, <span class="number">3</span>)</span><br><span class="line"><span class="keyword">assert</span>(c2 &lt; N)</span><br><span class="line"></span><br><span class="line">m1 = <span class="built_in">pow</span>(c1, e, N)</span><br><span class="line">m2 = <span class="built_in">pow</span>(c2, e, N)</span><br><span class="line"></span><br><span class="line">output = <span class="built_in">open</span>(<span class="string">&#x27;secret&#x27;</span>, <span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">output.write(<span class="string">&#x27;N=&#x27;</span> + <span class="built_in">str</span>(N) + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">output.write(<span class="string">&#x27;m1=&#x27;</span> + <span class="built_in">str</span>(m1) + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">output.write(<span class="string">&#x27;m2=&#x27;</span> + <span class="built_in">str</span>(m2) + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">output.close()</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">N=636585149594574746909030160182690866222909256464847291783000651837227921337237899651287943597773270944384034858925295744880727101606841413640006527614873110651410155893776548737823152943797884729130149758279127430044739254000426610922834573094957082589539445610828279428814524313491262061930512829074466232633130599104490893572093943832740301809630847541592548921200288222432789208650949937638303429456468889100192613859073752923812454212239908948930178355331390933536771065791817643978763045030833712326162883810638120029378337092938662174119747687899484603628344079493556601422498405360731958162719296160584042671057160241284852522913676264596201906163</span></span><br><span class="line"><span class="string">m1=90009974341452243216986938028371257528604943208941176518717463554774967878152694586469377765296113165659498726012712288670458884373971419842750929287658640266219686646956929872115782173093979742958745121671928568709468526098715927189829600497283118051641107305128852697032053368115181216069626606165503465125725204875578701237789292966211824002761481815276666236869005129138862782476859103086726091860497614883282949955023222414333243193268564781621699870412557822404381213804026685831221430728290755597819259339616650158674713248841654338515199405532003173732520457813901170264713085107077001478083341339002069870585378257051150217511755761491021553239</span></span><br><span class="line"><span class="string">m2=487443985757405173426628188375657117604235507936967522993257972108872283698305238454465723214226871414276788912058186197039821242912736742824080627680971802511206914394672159240206910735850651999316100014691067295708138639363203596244693995562780286637116394738250774129759021080197323724805414668042318806010652814405078769738548913675466181551005527065309515364950610137206393257148357659666687091662749848560225453826362271704292692847596339533229088038820532086109421158575841077601268713175097874083536249006018948789413238783922845633494023608865256071962856581229890043896939025613600564283391329331452199062858930374565991634191495137939574539546</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="分析-9">分析：</h4>
<p>1，两个大素数接近，先yafu分解，进而得到phi</p>
<p>2，根据代码过程可以发现c1,c2 存在立方和关系，对其进行推导： <span class="math display">\[
c_1 = F_1+F_2,c_2=F_1^3+F_2^3,and, (a+b)*(a^2-a*b+b^2)=a^3+b^3
\]</span> 3,整理以上得到： <span class="math display">\[
F_1+F_2=X,F_1*F_2 = Y,and,get \iff F_2^2 -Y*F_2+F_2=0
\]</span> 4，解一元二次方程并对结果进行转换和拼接</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">n= <span class="number">636585149594574746909030160182690866222909256464847291783000651837227921337237899651287943597773270944384034858925295744880727101606841413640006527614873110651410155893776548737823152943797884729130149758279127430044739254000426610922834573094957082589539445610828279428814524313491262061930512829074466232633130599104490893572093943832740301809630847541592548921200288222432789208650949937638303429456468889100192613859073752923812454212239908948930178355331390933536771065791817643978763045030833712326162883810638120029378337092938662174119747687899484603628344079493556601422498405360731958162719296160584042671057160241284852522913676264596201906163</span></span><br><span class="line">m1=<span class="number">90009974341452243216986938028371257528604943208941176518717463554774967878152694586469377765296113165659498726012712288670458884373971419842750929287658640266219686646956929872115782173093979742958745121671928568709468526098715927189829600497283118051641107305128852697032053368115181216069626606165503465125725204875578701237789292966211824002761481815276666236869005129138862782476859103086726091860497614883282949955023222414333243193268564781621699870412557822404381213804026685831221430728290755597819259339616650158674713248841654338515199405532003173732520457813901170264713085107077001478083341339002069870585378257051150217511755761491021553239</span></span><br><span class="line">m2=<span class="number">487443985757405173426628188375657117604235507936967522993257972108872283698305238454465723214226871414276788912058186197039821242912736742824080627680971802511206914394672159240206910735850651999316100014691067295708138639363203596244693995562780286637116394738250774129759021080197323724805414668042318806010652814405078769738548913675466181551005527065309515364950610137206393257148357659666687091662749848560225453826362271704292692847596339533229088038820532086109421158575841077601268713175097874083536249006018948789413238783922845633494023608865256071962856581229890043896939025613600564283391329331452199062858930374565991634191495137939574539546</span></span><br><span class="line">e= <span class="number">65537</span></span><br><span class="line">p = <span class="number">797862863902421984951231350430312260517773269684958456342860983236184129602390919026048496119757187702076499551310794177917920137646835888862706126924088411570997141257159563952725882214181185531209186972351469946269508511312863779123205322378452194261217016552527754513215520329499967108196968833163329724620251096080377748737</span></span><br><span class="line">q =<span class="number">797862863902421984951231350430312260517773269684958456342860983236184129602390919026048496119757187702076499551310794177917920137646835888862706126924088411570997141257159563952725882214181185531209186972351469946269508511312863779123205322378452194261217016552527754513215520329499967108196968833163329724620251096080377747699</span></span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e,phi)</span><br><span class="line">c1 = <span class="built_in">pow</span>(m1,d,n)</span><br><span class="line">c2 = <span class="built_in">pow</span>(m2,d,n)</span><br><span class="line"><span class="built_in">print</span>(c1,c2)</span><br><span class="line">c1 = <span class="number">2732509502629189160482346120094198557857912754</span></span><br><span class="line">c2 = <span class="number">5514544075236012543362261483183657422998274674127032311399076783844902086865451355210243586349132992563718009577051164928513093068525554</span></span><br><span class="line"><span class="built_in">print</span>(c2//c1)</span><br><span class="line">mid = <span class="number">2018124390758744579176881760393912432855047177830525334114351200861828082292382837553703201</span></span><br><span class="line"><span class="built_in">print</span>((c1**<span class="number">2</span>-mid)//<span class="number">3</span>)</span><br><span class="line">ab = <span class="number">1816161263733358048121941530698342818827717719035680583254778301273837138120341137307387105</span></span><br><span class="line">aplusb = <span class="number">2732509502629189160482346120094198557857912754</span></span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> *</span><br><span class="line">x = symbols(<span class="string">&#x27;x&#x27;</span>)</span><br><span class="line">m = solve(Eq(x**<span class="number">2</span>- aplusb*x + ab,<span class="number">0</span>),x)</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line">f1 = <span class="number">1141553212031156130619789508463772513350070909</span></span><br><span class="line">f2 = <span class="number">1590956290598033029862556611630426044507841845</span></span><br><span class="line">fr = long_to_bytes(f1)</span><br><span class="line">fh = long_to_bytes(f2)</span><br><span class="line"><span class="built_in">print</span>(fr,fh)</span><br></pre></td></tr></table></figure>
<h3 id="no.13-md5rsa">NO.13 md5&amp;rsa</h3>
<p>BUU rsa2：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">N = <span class="number">101991809777553253470276751399264740131157682329252673501792154507006158434432009141995367241962525705950046253400188884658262496534706438791515071885860897552736656899566915731297225817250639873643376310103992170646906557242832893914902053581087502512787303322747780420210884852166586717636559058152544979471</span></span><br><span class="line">e = <span class="number">46731919563265721307105180410302518676676135509737992912625092976849075262192092549323082367518264378630543338219025744820916471913696072050291990620486581719410354385121760761374229374847695148230596005409978383369740305816082770283909611956355972181848077519920922059268376958811713365106925235218265173085</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">flag = <span class="string">&quot;flag&#123;&quot;</span> + hashlib.md5(<span class="built_in">hex</span>(d)).hexdigest() + <span class="string">&quot;&#125;&quot;</span></span><br></pre></td></tr></table></figure>
<p>大数分解素数可以得到p与q，但是进行编码时因为python3与2的md5编码方式区别导致类型错误，在<a target="_blank" rel="noopener" href="https://c.runoob.com/compile/6/">在线python2环境</a>中运行代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">d= <span class="number">8920758995414587152829426558580025657357328745839747693739591820283538307445</span></span><br><span class="line">a = hashlib.md5(<span class="built_in">hex</span>(d)).hexdigest()</span><br><span class="line"><span class="built_in">print</span>(a)</span><br></pre></td></tr></table></figure>
<p>修正——维纳攻击</p>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/%E7%BB%83%E4%B9%A0%E9%A2%98/" rel="tag"># 练习题</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2021/10/12/WTR/" rel="prev" title="WTR">
      <i class="fa fa-chevron-left"></i> WTR
    </a></div>
      <div class="post-nav-item">
    <a href="/2021/10/13/%E7%89%B9%E5%BE%81%E5%88%86%E6%9E%90/" rel="next" title="特征分析">
      特征分析 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#oct.13th.2021_build_to_record"><span class="nav-number">1.</span> <span class="nav-text">Oct.13th.2021_build_to_record</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E9%A2%98%E7%9B%AE%E9%83%BD%E6%98%AF%E4%B8%89%E7%BA%A7%E6%A0%87%E9%A2%98"><span class="nav-number">2.</span> <span class="nav-text">题目都是三级标题</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#type1rsa"><span class="nav-number">2.1.</span> <span class="nav-text">TYPE1:RSA</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#no.1-%E5%90%AB%E6%9C%89ouput%E6%96%87%E4%BB%B6%E7%9A%84%E4%B8%80%E9%81%93%E7%B4%AF%E4%B9%98%E5%8F%8A%E5%BE%AA%E7%8E%AF%E5%8A%A0%E5%AF%86%E8%BE%93%E5%87%BAoct.9.2021"><span class="nav-number">2.1.1.</span> <span class="nav-text">NO.1 含有ouput文件的一道累乘及循环加密输出oct.9.2021</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%86%E6%9E%90"><span class="nav-number">2.1.1.1.</span> <span class="nav-text">分析：</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#no.2-%E5%BC%82%E6%88%96%E8%BF%90%E7%AE%97%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%95%B0%E6%8D%AE%E7%A7%BB%E4%BD%8Dbin%E7%9A%84%E5%BA%94%E7%94%A8%E7%89%B9%E5%BE%81%E5%88%86%E6%9E%90oct.13.2021"><span class="nav-number">2.1.2.</span> <span class="nav-text">NO.2 异或运算、二进制数据移位、bin()的应用、特征分析oct.13.2021</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%86%E6%9E%90-1"><span class="nav-number">2.1.2.1.</span> <span class="nav-text">分析：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%80%BB%E7%BB%93"><span class="nav-number">2.1.2.2.</span> <span class="nav-text">总结：</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#no.3-%E5%85%AC%E5%BC%8F%E6%8E%A8%E5%AF%BC-crt%E6%A8%A1%E8%BF%90%E7%AE%97"><span class="nav-number">2.1.3.</span> <span class="nav-text">NO.3 公式推导 &amp;CRT&amp;模运算</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%86%E6%9E%90-2"><span class="nav-number">2.1.3.1.</span> <span class="nav-text">分析：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#crt_code"><span class="nav-number">2.1.3.2.</span> <span class="nav-text">CRT_code:</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8E%A8%E5%AF%BC_code"><span class="nav-number">2.1.3.3.</span> <span class="nav-text">推导_code:</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%8E%A8%E5%AF%BC%E8%BF%87%E7%A8%8B"><span class="nav-number">2.1.3.3.1.</span> <span class="nav-text">推导过程：</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#no.4-dpdq-%E6%B3%84%E9%9C%B2"><span class="nav-number">2.1.4.</span> <span class="nav-text">NO.4 dp&amp;dq 泄露</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9D%A1%E4%BB%B6"><span class="nav-number">2.1.4.1.</span> <span class="nav-text">条件：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%86%E6%9E%90-3"><span class="nav-number">2.1.4.2.</span> <span class="nav-text">分析：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8E%A8%E5%AF%BC%E8%BF%87%E7%A8%8B-1"><span class="nav-number">2.1.4.3.</span> <span class="nav-text">推导过程：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%80%BB%E7%BB%93-1"><span class="nav-number">2.1.4.4.</span> <span class="nav-text">总结：</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#no.5-dp_leak-python%E5%AD%A6%E4%B9%A0"><span class="nav-number">2.1.5.</span> <span class="nav-text">NO.5 dp_leak Python学习</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9D%A1%E4%BB%B6-1"><span class="nav-number">2.1.5.1.</span> <span class="nav-text">条件：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%86%E6%9E%90-4"><span class="nav-number">2.1.5.2.</span> <span class="nav-text">分析：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8E%A8%E5%AF%BC%E8%BF%87%E7%A8%8B-2"><span class="nav-number">2.1.5.3.</span> <span class="nav-text">推导过程：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%80%BB%E7%BB%93-2"><span class="nav-number">2.1.5.4.</span> <span class="nav-text">总结：</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#no.6-%E5%B0%8F%E6%98%8E%E6%96%87"><span class="nav-number">2.1.6.</span> <span class="nav-text">NO.6 小明文</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%86%E6%9E%90-5"><span class="nav-number">2.1.6.1.</span> <span class="nav-text">分析：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%80%BB%E7%BB%93-3"><span class="nav-number">2.1.6.2.</span> <span class="nav-text">总结：</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#no.7-%E5%85%B1%E6%A8%A1%E6%94%BB%E5%87%BB"><span class="nav-number">2.1.7.</span> <span class="nav-text">NO.7 共模攻击</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9D%A1%E4%BB%B6-2"><span class="nav-number">2.1.7.1.</span> <span class="nav-text">条件：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%86%E6%9E%90-6"><span class="nav-number">2.1.7.2.</span> <span class="nav-text">分析：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8E%A8%E5%AF%BC%E8%BF%87%E7%A8%8B%E4%BF%AE%E6%AD%A3%E9%80%86%E5%85%83%E8%B4%9F%E6%8C%87%E6%95%B0%E5%B9%82"><span class="nav-number">2.1.7.3.</span> <span class="nav-text">推导过程：(修正，逆元&amp;负指数幂)</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#no.8-openssl-rsa-kali-kali%E4%B8%8D%E5%A5%BD%E7%94%A8%E5%B0%B1%E7%94%A8%E8%81%9A%E7%84%A6terminal"><span class="nav-number">2.1.8.</span> <span class="nav-text">NO.8 openssl &amp; rsa &amp; kali &amp; kali不好用就用聚焦Terminal</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#no.9-e%E4%B8%8Ephin%E4%B8%8D%E4%BA%92%E7%B4%A0"><span class="nav-number">2.1.9.</span> <span class="nav-text">NO.9 e与\(\phi(n)\)不互素</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9D%A1%E4%BB%B6-3"><span class="nav-number">2.1.9.1.</span> <span class="nav-text">条件：</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#no.10-crt%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="nav-number">2.1.10.</span> <span class="nav-text">NO.10 CRT&amp;正则表达式</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%86%E6%9E%90-7"><span class="nav-number">2.1.10.1.</span> <span class="nav-text">分析：</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#no.11-%E5%AF%BC%E6%95%B0%E5%92%8Crsa"><span class="nav-number">2.1.11.</span> <span class="nav-text">NO.11 导数和RSA</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%86%E6%9E%90-8"><span class="nav-number">2.1.11.1.</span> <span class="nav-text">分析：</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#no.12-%E7%AB%8B%E6%96%B9%E5%92%8C%E5%B7%AE%E5%85%AC%E5%BC%8F-yafu-%E6%8B%BC%E6%8E%A5-sympy"><span class="nav-number">2.1.12.</span> <span class="nav-text">NO.12 立方和差公式 yafu 拼接 sympy</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%86%E6%9E%90-9"><span class="nav-number">2.1.12.1.</span> <span class="nav-text">分析：</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#no.13-md5rsa"><span class="nav-number">2.1.13.</span> <span class="nav-text">NO.13 md5&amp;rsa</span></a></li></ol></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">expansehi</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">13</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
        <span class="site-state-item-count">5</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">5</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">expansehi</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  

</body>
</html>
